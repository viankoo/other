Message-ID: <715452048.10591.1546418142111.JavaMail.root@shjhkftoolssrv.ciicsh.local>
Subject: Exported From Confluence
MIME-Version: 1.0
Content-Type: multipart/related; 
	boundary="----=_Part_10590_150982930.1546418142110"

------=_Part_10590_150982930.1546418142110
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Content-Location: file:///C:/exported.html

<html xmlns:o=3D'urn:schemas-microsoft-com:office:office'
      xmlns:w=3D'urn:schemas-microsoft-com:office:word'
      xmlns:v=3D'urn:schemas-microsoft-com:vml'
      xmlns=3D'urn:w3-org-ns:HTML'>
<head>
    <meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf-8=
">
    <title>Spring+MyBatis=E5=AE=9E=E7=8E=B0=E6=95=B0=E6=8D=AE=E5=BA=93=E8=
=AF=BB=E5=86=99=E5=88=86=E7=A6=BB=E6=96=B9=E6=A1=88</title>
    <!--[if gte mso 9]>
    <xml>
        <o:OfficeDocumentSettings>
            <o:TargetScreenSize>1024x640</o:TargetScreenSize>
            <o:PixelsPerInch>72</o:PixelsPerInch>
            <o:AllowPNG/>
        </o:OfficeDocumentSettings>
        <w:WordDocument>
            <w:View>Print</w:View>
            <w:Zoom>90</w:Zoom>
            <w:DoNotOptimizeForBrowser/>
        </w:WordDocument>
    </xml>
    <![endif]-->
    <style>
                <!--
        @page Section1 {
            size: 8.5in 11.0in;
            margin: 1.0in;
            mso-header-margin: .5in;
            mso-footer-margin: .5in;
            mso-paper-source: 0;
        }

        table {
            border: solid 1px;
            border-collapse: collapse;
        }

        table td, table th {
            border: solid 1px;
            padding: 5px;
        }

        td {
            page-break-inside: avoid;
        }

        tr {
            page-break-after: avoid;
        }

        div.Section1 {
            page: Section1;
        }

        /* Confluence print stylesheet. Common to all themes for print medi=
a */
/* Full of !important until we improve batching for print CSS */

@media print {
    #main {
        padding-bottom: 1em !important; /* The default padding of 6em is to=
o much for printouts */
    }

    body {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        font-size: 10pt;
        line-height: 1.2;
    }

    body, #full-height-container, #main, #page, #content, .has-personal-sid=
ebar #content {
        background: #fff !important;
        color: #000 !important;
        border: 0 !important;
        width: 100% !important;
        height: auto !important;
        min-height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        display: block !important;
    }

    a, a:link, a:visited, a:focus, a:hover, a:active {
        color: #000;
    }

    #content h1,
    #content h2,
    #content h3,
    #content h4,
    #content h5,
    #content h6 {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        page-break-after: avoid;
    }

    pre {
        font-family: Monaco, "Courier New", monospace;
    }

    #header,
    .aui-header-inner,
    #navigation,
    #sidebar,
    .sidebar,
    #personal-info-sidebar,
    .ia-fixed-sidebar,
    .page-actions,
    .navmenu,
    .ajs-menu-bar,
    .noprint,
    .inline-control-link,
    .inline-control-link a,
    a.show-labels-editor,
    .global-comment-actions,
    .comment-actions,
    .quick-comment-container,
    #addcomment {
        display: none !important;
    }

    /* CONF-28544 cannot print multiple pages in IE */
    #splitter-content {
        position: relative !important;
    }

    .comment .date::before {
        content: none !important; /* remove middot for print view */
    }

    h1.pagetitle img {
        height: auto;
        width: auto;
    }

    .print-only {
        display: block;
    }

    #footer {
        position: relative !important; /* CONF-17506 Place the footer at en=
d of the content */
        margin: 0;
        padding: 0;
        background: none;
        clear: both;
    }

    #poweredby {
        border-top: none;
        background: none;
    }

    #poweredby li.print-only {
        display: list-item;
        font-style: italic;
    }

    #poweredby li.noprint {
        display: none;
    }

    /* no width controls in print */
    .wiki-content .table-wrap,
    .wiki-content p,
    .panel .codeContent,
    .panel .codeContent pre,
    .image-wrap {
        overflow: visible !important;
    }

    /* TODO - should this work? */
    #children-section,
    #comments-section .comment,
    #comments-section .comment .comment-body,
    #comments-section .comment .comment-content,
    #comments-section .comment p {
        page-break-inside: avoid;
    }

    #page-children a {
        text-decoration: none;
    }

    /**
     hide twixies

     the specificity here is a hack because print styles
     are getting loaded before the base styles. */
    #comments-section.pageSection .section-header,
    #comments-section.pageSection .section-title,
    #children-section.pageSection .section-header,
    #children-section.pageSection .section-title,
    .children-show-hide {
        padding-left: 0;
        margin-left: 0;
    }

    .children-show-hide.icon {
        display: none;
    }

    /* personal sidebar */
    .has-personal-sidebar #content {
        margin-right: 0px;
    }

    .has-personal-sidebar #content .pageSection {
        margin-right: 0px;
    }

    .no-print, .no-print * {
        display: none !important;
    }
}
-->
    </style>
</head>
<body>
    <h1>Spring+MyBatis=E5=AE=9E=E7=8E=B0=E6=95=B0=E6=8D=AE=E5=BA=93=E8=AF=
=BB=E5=86=99=E5=88=86=E7=A6=BB=E6=96=B9=E6=A1=88</h1>
    <div class=3D"Section1">
        <blockquote style=3D"margin-left: 0.0px;">
<p style=3D"text-align: justify;">=E6=8E=A8=E8=8D=90=E7=AC=AC=E5=9B=9B=E7=
=A7=8D</p>
</blockquote>
<h5 id=3D"Spring+MyBatis=E5=AE=9E=E7=8E=B0=E6=95=B0=E6=8D=AE=E5=BA=93=E8=AF=
=BB=E5=86=99=E5=88=86=E7=A6=BB=E6=96=B9=E6=A1=88-=E6=96=B9=E6=A1=881">=E6=
=96=B9=E6=A1=881</h5>
<blockquote style=3D"margin-left: 0.0px;">
<p style=3D"text-align: justify;">=E9=80=9A=E8=BF=87MyBatis=E9=85=8D=E7=BD=
=AE=E6=96=87=E4=BB=B6=E5=88=9B=E5=BB=BA=E8=AF=BB=E5=86=99=E5=88=86=E7=A6=BB=
=E4=B8=A4=E4=B8=AADataSource=EF=BC=8C=E6=AF=8F=E4=B8=AASqlSessionFactoryBea=
n=E5=AF=B9=E8=B1=A1=E7=9A=84mapperLocations=E5=B1=9E=E6=80=A7=E5=88=B6=E5=
=AE=9A=E4=B8=A4=E4=B8=AA=E8=AF=BB=E5=86=99=E6=95=B0=E6=8D=AE=E6=BA=90=E7=9A=
=84=E9=85=8D=E7=BD=AE=E6=96=87=E4=BB=B6=E3=80=82=E5=B0=86=E6=89=80=E6=9C=89=
=E8=AF=BB=E7=9A=84=E6=93=8D=E4=BD=9C=E9=85=8D=E7=BD=AE=E5=9C=A8=E8=AF=BB=E6=
=96=87=E4=BB=B6=E4=B8=AD=EF=BC=8C=E6=89=80=E6=9C=89=E5=86=99=E7=9A=84=E6=93=
=8D=E4=BD=9C=E9=85=8D=E7=BD=AE=E5=9C=A8=E5=86=99=E6=96=87=E4=BB=B6=E4=B8=AD=
=E3=80=82</p>
</blockquote>
<ul style=3D"text-align: justify;margin-left: 25.0px;">
<li>=E4=BC=98=E7=82=B9=EF=BC=9A=E5=AE=9E=E7=8E=B0=E7=AE=80=E5=8D=95</li>
<li>=E7=BC=BA=E7=82=B9=EF=BC=9A=E7=BB=B4=E6=8A=A4=E9=BA=BB=E7=83=A6=EF=BC=
=8C=E9=9C=80=E8=A6=81=E5=AF=B9=E5=8E=9F=E6=9C=89=E7=9A=84xml=E6=96=87=E4=BB=
=B6=E8=BF=9B=E8=A1=8C=E9=87=8D=E6=96=B0=E4=BF=AE=E6=94=B9=EF=BC=8C=E4=B8=8D=
=E6=94=AF=E6=8C=81=E5=A4=9A=E8=AF=BB=EF=BC=8C=E4=B8=8D=E6=98=93=E6=89=A9=E5=
=B1=95</li>
<li>=E5=AE=9E=E7=8E=B0=E6=96=B9=E5=BC=8F</li>
</ul>
<pre class=3D"hljs xml"><code class=3D"xml"><span class=3D"hljs-tag" style=
=3D"color: rgb(0,102,102);">&lt;<span class=3D"hljs-title" style=3D"color: =
rgb(38,139,210);">bean</span> <span class=3D"hljs-attribute" style=3D"color=
: rgb(181,137,0);">id</span>=3D<span class=3D"hljs-value" style=3D"color: r=
gb(42,161,152);">"abstractDataSource"</span> <span class=3D"hljs-attribute"=
 style=3D"color: rgb(181,137,0);">abstract</span>=3D<span class=3D"hljs-val=
ue" style=3D"color: rgb(42,161,152);">"true"</span> <span class=3D"hljs-att=
ribute" style=3D"color: rgb(181,137,0);">class</span>=3D<span class=3D"hljs=
-value" style=3D"color: rgb(42,161,152);">"com.alibaba.druid.pool.DruidData=
Source"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0=
);">init-method</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,=
161,152);">"init"</span> <span class=3D"hljs-attribute" style=3D"color: rgb=
(181,137,0);">destroy-method</span>=3D<span class=3D"hljs-value" style=3D"c=
olor: rgb(42,161,152);">"close"</span>&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassName"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"co=
m.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E8=8E=B7=E5=8F=96=E8=BF=9E=E6=8E=A5=E7=AD=89=E5=BE=85=
=E8=B6=85=E6=97=B6=E7=9A=84=E6=97=B6=E9=97=B4 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxWait"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"60000"</sp=
an>/&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E9=97=B4=E9=9A=94=E5=A4=9A=E4=B9=85=E6=89=8D=E8=BF=9B=
=E8=A1=8C=E4=B8=80=E6=AC=A1=E6=A3=80=E6=B5=8B=EF=BC=8C=E6=A3=80=E6=B5=8B=E9=
=9C=80=E8=A6=81=E5=85=B3=E9=97=AD=E7=9A=84=E7=A9=BA=E9=97=B2=E8=BF=9E=E6=8E=
=A5=EF=BC=8C=E5=8D=95=E4=BD=8D=E6=98=AF=E6=AF=AB=E7=A7=92 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"timeBetweenEvicti=
onRunsMillis"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181=
,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,=
161,152);">"60000"</span>/&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E4=B8=80=E4=B8=AA=E8=BF=9E=E6=8E=A5=E5=9C=A8=E6=B1=A0=
=E4=B8=AD=E6=9C=80=E5=B0=8F=E7=94=9F=E5=AD=98=E7=9A=84=E6=97=B6=E9=97=B4=EF=
=BC=8C=E5=8D=95=E4=BD=8D=E6=98=AF=E6=AF=AB=E7=A7=92 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minEvictableIdleT=
imeMillis"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,13=
7,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161=
,152);">"300000"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"validationQuery"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"SE=
LECT 'x'"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testWhileIdle"</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"true=
"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testOnBorrow"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"false=
"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testOnReturn"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"false=
"</span>/&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E6=89=93=E5=BC=80PSCache=EF=BC=8C=E5=B9=B6=E4=B8=94=E6=8C=87=E5=AE=9A=E6=
=AF=8F=E4=B8=AA=E8=BF=9E=E6=8E=A5=E4=B8=8APSCache=E7=9A=84=E5=A4=A7=E5=B0=
=8F --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"poolPreparedState=
ments"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0)=
;">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152=
);">"true"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxPoolPreparedSt=
atementPerConnectionSize"</span> <span class=3D"hljs-attribute" style=3D"co=
lor: rgb(181,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"co=
lor: rgb(42,161,152);">"20"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"filters"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"config"</s=
pan>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"connectionPropert=
ies"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);"=
>value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);=
">"config.decrypt=3Dtrue"</span> /&gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"readDataSource"</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</spa=
n>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstract=
DataSource"</span>&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password --&=
gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <span=
 class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=3D<=
span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read.jdbc.ur=
l}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span=
>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read.jd=
bc.user}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span=
>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read.jd=
bc.password}"</span>/&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=81=
=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read=
.jdbc.initPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"10"</span>=
/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</spa=
n>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read.j=
dbc.maxPoolSize}"</span>/&gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"writeDataSource"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstrac=
tDataSource"</span>&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password --&=
gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <span=
 class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=3D<=
span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${write.jdbc.u=
rl}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span=
>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${write.j=
dbc.user}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span=
>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${write.j=
dbc.password}"</span>/&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=81=
=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${writ=
e.jdbc.initPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"10"</span>=
/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</spa=
n>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${write.=
jdbc.maxPoolSize}"</span>/&gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"readSqlSessionFactory"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">clas=
s</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"or=
g.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E5=AE=9E=E4=BE=8B=E5=8C=96sqlSessionFactory=E6=97=B6=E9=9C=80=E8=A6=81=E4=
=BD=BF=E7=94=A8=E4=B8=8A=E8=BF=B0=E9=85=8D=E7=BD=AE=E5=A5=BD=E7=9A=84=E6=95=
=B0=E6=8D=AE=E6=BA=90=E4=BB=A5=E5=8F=8ASQL=E6=98=A0=E5=B0=84=E6=96=87=E4=BB=
=B6 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</span=
> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</span=
>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"readDataS=
ource"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"mapperLocations"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"cl=
asspath:mapper/read/*.xml"</span>/&gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"writeSqlSessionFactory"=
</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">cla=
ss</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"o=
rg.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E5=AE=9E=E4=BE=8B=E5=8C=96sqlSessionFactory=E6=97=B6=E9=9C=80=E8=A6=81=E4=
=BD=BF=E7=94=A8=E4=B8=8A=E8=BF=B0=E9=85=8D=E7=BD=AE=E5=A5=BD=E7=9A=84=E6=95=
=B0=E6=8D=AE=E6=BA=90=E4=BB=A5=E5=8F=8ASQL=E6=98=A0=E5=B0=84=E6=96=87=E4=BB=
=B6 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</span=
> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</span=
>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"writeData=
Source"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <span c=
lass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"mapperLocations"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"cl=
asspath:mapper/write/*.xml"</span>/&gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span></c=
ode></pre>
<h5 id=3D"Spring+MyBatis=E5=AE=9E=E7=8E=B0=E6=95=B0=E6=8D=AE=E5=BA=93=E8=AF=
=BB=E5=86=99=E5=88=86=E7=A6=BB=E6=96=B9=E6=A1=88-=E6=96=B9=E6=A1=882">=E6=
=96=B9=E6=A1=882</h5>
<blockquote style=3D"margin-left: 0.0px;">
<p style=3D"text-align: justify;">=E9=80=9A=E8=BF=87<a class=3D"external-li=
nk" title=3D"Java EE=E7=9F=A5=E8=AF=86=E5=BA=93" href=3D"http://lib.csdn.ne=
t/base/javaee" rel=3D"nofollow">spring</a>&nbsp;AOP=E5=9C=A8=E4=B8=9A=E5=8A=
=A1=E5=B1=82=E5=AE=9E=E7=8E=B0=E8=AF=BB=E5=86=99=E5=88=86=E7=A6=BB=EF=BC=8C=
=E5=9C=A8DAO=E5=B1=82=E8=B0=83=E7=94=A8=E5=89=8D=E5=AE=9A=E4=B9=89=E5=88=87=
=E9=9D=A2=EF=BC=8C=E5=88=A9=E7=94=A8Spring=E7=9A=84AbstractRoutingDataSourc=
e=E8=A7=A3=E5=86=B3=E5=A4=9A=E6=95=B0=E6=8D=AE=E6=BA=90=E7=9A=84=E9=97=AE=
=E9=A2=98=EF=BC=8C=E5=AE=9E=E7=8E=B0=E5=8A=A8=E6=80=81=E9=80=89=E6=8B=A9=E6=
=95=B0=E6=8D=AE=E6=BA=90</p>
</blockquote>
<ul style=3D"text-align: justify;margin-left: 25.0px;">
<li>=E4=BC=98=E7=82=B9=EF=BC=9A=E9=80=9A=E8=BF=87=E6=B3=A8=E8=A7=A3=E7=9A=
=84=E6=96=B9=E6=B3=95=E5=9C=A8DAO=E6=AF=8F=E4=B8=AA=E6=96=B9=E6=B3=95=E4=B8=
=8A=E9=85=8D=E7=BD=AE=E6=95=B0=E6=8D=AE=E6=BA=90=EF=BC=8C=E5=8E=9F=E6=9C=89=
=E4=BB=A3=E7=A0=81=E6=94=B9=E5=8A=A8=E9=87=8F=E5=B0=91=EF=BC=8C=E6=98=93=E6=
=89=A9=E5=B1=95=EF=BC=8C=E6=94=AF=E6=8C=81=E5=A4=9A=E8=AF=BB</li>
<li>=E7=BC=BA=E7=82=B9=EF=BC=9A=E9=9C=80=E8=A6=81=E5=9C=A8DAO=E6=AF=8F=E4=
=B8=AA=E6=96=B9=E6=B3=95=E4=B8=8A=E9=85=8D=E7=BD=AE=E6=B3=A8=E8=A7=A3=EF=BC=
=8C=E4=BA=BA=E5=B7=A5=E7=AE=A1=E7=90=86=EF=BC=8C=E5=AE=B9=E6=98=93=E5=87=BA=
=E9=94=99</li>
<li>=E5=AE=9E=E7=8E=B0=E6=96=B9=E5=BC=8F</li>
</ul>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-comment" =
style=3D"color: rgb(147,161,161);">//=E5=AE=9A=E4=B9=89=E6=9E=9A=E4=B8=BE=
=E7=B1=BB=E5=9E=8B=EF=BC=8C=E8=AF=BB=E5=86=99</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">enum</span> =
DynamicDataSourceGlobal {
    READ, WRITE;
}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> java.lang.annotation.Element=
Type;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.annotation.Retention;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.annotation.RetentionPolicy;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.annotation.Target;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * RUNTI=
ME * =E5=AE=9A=E4=B9=89=E6=B3=A8=E8=A7=A3 * =E7=BC=96=E8=AF=91=E5=99=A8=E5=
=B0=86=E6=8A=8A=E6=B3=A8=E9=87=8A=E8=AE=B0=E5=BD=95=E5=9C=A8=E7=B1=BB=E6=96=
=87=E4=BB=B6=E4=B8=AD=EF=BC=8C=E5=9C=A8=E8=BF=90=E8=A1=8C=E6=97=B6 VM =E5=
=B0=86=E4=BF=9D=E7=95=99=E6=B3=A8=E9=87=8A=EF=BC=8C=E5=9B=A0=E6=AD=A4=E5=8F=
=AF=E4=BB=A5=E5=8F=8D=E5=B0=84=E6=80=A7=E5=9C=B0=E8=AF=BB=E5=8F=96=E3=80=82=
 * <span class=3D"hljs-doctag" style=3D"color: rgb(42,161,152);">@author</s=
pan> shma1664 * */</span>
<span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Retenti=
on</span>(RetentionPolicy.RUNTIME)
<span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Target<=
/span>(ElementType.METHOD)
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@interf=
ace</span> DataSource {

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> DynamicDataSourceGlobal <span class=3D"h=
ljs-title" style=3D"color: rgb(38,139,210);">value</span><span class=3D"hlj=
s-params" style=3D"color: rgb(102,0,102);">()</span> <span class=3D"hljs-ke=
yword" style=3D"color: rgb(133,153,0);">default</span> DynamicDataSourceGlo=
bal.READ</span>;

}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-comment" =
style=3D"color: rgb(147,161,161);">/** * Created by IDEA * =E6=9C=AC=E5=9C=
=B0=E7=BA=BF=E7=A8=8B=E8=AE=BE=E7=BD=AE=E5=92=8C=E8=8E=B7=E5=8F=96=E6=95=B0=
=E6=8D=AE=E6=BA=90=E4=BF=A1=E6=81=AF * User: mashaohua * Date: 2016-07-07 1=
3:35 * Desc: */</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicDataSourceHolder</span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> ThreadLocal&lt;DynamicDataSourceGlobal&gt; holder =3D <span class=3D=
"hljs-keyword" style=3D"color: rgb(133,153,0);">new</span> ThreadLocal&lt;D=
ynamicDataSourceGlobal&gt;();

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"colo=
r: rgb(38,139,210);">putDataSource</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(DynamicDataSourceGlobal dataSource)</span></sp=
an>{
        holder.set(dataSource);
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> DynamicDataSourceGlobal <span class=3D"=
hljs-title" style=3D"color: rgb(38,139,210);">getDataSource</span><span cla=
ss=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span></span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> holder.get();
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"colo=
r: rgb(38,139,210);">clearDataSource</span><span class=3D"hljs-params" styl=
e=3D"color: rgb(102,0,102);">()</span> </span>{
        holder.remove();
    }

}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> org.springframework.jdbc.dat=
asource.lookup.AbstractRoutingDataSource;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.HashMap;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.List;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.Map;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.ThreadLocalRandom;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.atomic.AtomicLong;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.locks.Lock;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.locks.ReentrantLock;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * Creat=
ed by IDEA * User: mashaohua * Date: 2016-07-14 10:56 * Desc: =E5=8A=A8=E6=
=80=81=E6=95=B0=E6=8D=AE=E6=BA=90=E5=AE=9E=E7=8E=B0=E8=AF=BB=E5=86=99=E5=88=
=86=E7=A6=BB */</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicDataSource</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">extends</span> <span class=3D"hljs-title" style=3D=
"color: rgb(181,137,0);">AbstractRoutingDataSource</span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> Object writeDataSource; <span class=3D"hljs-comment" style=3D"color: =
rgb(147,161,161);">//=E5=86=99=E6=95=B0=E6=8D=AE=E6=BA=90</span>

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> List&lt;Object&gt; readDataSources; <span class=3D"hljs-comment" styl=
e=3D"color: rgb(147,161,161);">//=E5=A4=9A=E4=B8=AA=E8=AF=BB=E6=95=B0=E6=8D=
=AE=E6=BA=90</span>

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int</sp=
an> readDataSourceSize; <span class=3D"hljs-comment" style=3D"color: rgb(14=
7,161,161);">//=E8=AF=BB=E6=95=B0=E6=8D=AE=E6=BA=90=E4=B8=AA=E6=95=B0</span=
>

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int</sp=
an> readDataSourcePollPattern =3D <span class=3D"hljs-number" style=3D"colo=
r: rgb(42,161,152);">0</span>; <span class=3D"hljs-comment" style=3D"color:=
 rgb(147,161,161);">//=E8=8E=B7=E5=8F=96=E8=AF=BB=E6=95=B0=E6=8D=AE=E6=BA=
=90=E6=96=B9=E5=BC=8F=EF=BC=8C0=EF=BC=9A=E9=9A=8F=E6=9C=BA=EF=BC=8C1=EF=BC=
=9A=E8=BD=AE=E8=AF=A2</span>

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> AtomicLong counter =3D <span class=3D"hljs-keyword" style=3D"color: r=
gb(133,153,0);">new</span> AtomicLong(<span class=3D"hljs-number" style=3D"=
color: rgb(42,161,152);">0</span>);

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> Long MAX_POOL =3D Long.MAX_VALUE;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final</=
span> Lock lock =3D <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">new</span> ReentrantLock();

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">afterPropertiesSet</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this</s=
pan>.writeDataSource =3D=3D <span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">null</span>) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
hrow</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">n=
ew</span> IllegalArgumentException(<span class=3D"hljs-string" style=3D"col=
or: rgb(42,161,152);">"Property 'writeDataSource' is required"</span>);
        }
        setDefaultTargetDataSource(writeDataSource);
        Map&lt;Object, Object&gt; targetDataSources =3D <span class=3D"hljs=
-keyword" style=3D"color: rgb(133,153,0);">new</span> HashMap&lt;&gt;();
        targetDataSources.put(DynamicDataSourceGlobal.WRITE.name(), writeDa=
taSource);
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this</s=
pan>.readDataSources =3D=3D <span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">null</span>) {
            readDataSourceSize =3D <span class=3D"hljs-number" style=3D"col=
or: rgb(42,161,152);">0</span>;
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">els=
e</span> {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">f=
or</span>(<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int=
</span> i=3D<span class=3D"hljs-number" style=3D"color: rgb(42,161,152);">0=
</span>; i&lt;readDataSources.size(); i++) {
                targetDataSources.put(DynamicDataSourceGlobal.READ.name() +=
 i, readDataSources.get(i));
            }
            readDataSourceSize =3D readDataSources.size();
        }
        setTargetDataSources(targetDataSources);
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">super=
</span>.afterPropertiesSet();
    }

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> Object <span class=3D"hljs-title" sty=
le=3D"color: rgb(38,139,210);">determineCurrentLookupKey</span><span class=
=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span> </span>{

        DynamicDataSourceGlobal dynamicDataSourceGlobal =3D DynamicDataSour=
ceHolder.getDataSource();

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(dynamicDataSourceGlobal =3D=3D <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">null</span>
                || dynamicDataSourceGlobal =3D=3D DynamicDataSourceGlobal.W=
RITE
                || readDataSourceSize &lt;=3D <span class=3D"hljs-number" s=
tyle=3D"color: rgb(42,161,152);">0</span>) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> DynamicDataSourceGlobal.WRITE.name();
        }

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int</=
span> index =3D <span class=3D"hljs-number" style=3D"color: rgb(42,161,152)=
;">1</span>;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(readDataSourcePollPattern =3D=3D <span class=3D"hljs-number" style=3D"=
color: rgb(42,161,152);">1</span>) {
            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>//=E8=BD=AE=E8=AF=A2=E6=96=B9=E5=BC=8F</span>
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">l=
ong</span> currValue =3D counter.incrementAndGet();
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span>((currValue + <span class=3D"hljs-number" style=3D"color: rgb(42,16=
1,152);">1</span>) &gt;=3D MAX_POOL) {
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">try</span> {
                    lock.lock();
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">if</span>((currValue + <span class=3D"hljs-number" style=3D"color: r=
gb(42,161,152);">1</span>) &gt;=3D MAX_POOL) {
                        counter.set(<span class=3D"hljs-number" style=3D"co=
lor: rgb(42,161,152);">0</span>);
                    }
                } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,=
0);">finally</span> {
                    lock.unlock();
                }
            }
            index =3D (<span class=3D"hljs-keyword" style=3D"color: rgb(133=
,153,0);">int</span>) (currValue % readDataSourceSize);
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">els=
e</span> {
            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>//=E9=9A=8F=E6=9C=BA=E6=96=B9=E5=BC=8F</span>
            index =3D ThreadLocalRandom.current().nextInt(<span class=3D"hl=
js-number" style=3D"color: rgb(42,161,152);">0</span>, readDataSourceSize);
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> dynamicDataSourceGlobal.name() + index;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setWriteDataSource</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(Object writeDataSource)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.writeDataSource =3D writeDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setReadDataSources</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(List&lt;Object&gt; readDataSources)</span> =
</span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.readDataSources =3D readDataSources;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setReadDataSourcePollPattern</span><span class=3D"hljs-=
params" style=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" styl=
e=3D"color: rgb(133,153,0);">int</span> readDataSourcePollPattern)</span> <=
/span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.readDataSourcePollPattern =3D readDataSourcePollPattern;
    }
}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> org.apache.log4j.Logger;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.aspectj.lang.JoinPoint;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.aspectj.lang.reflect.MethodSignature;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.reflect.Method;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * Creat=
ed by IDEA * User: mashaohua * Date: 2016-07-07 13:39 * Desc: =E5=AE=9A=E4=
=B9=89=E9=80=89=E6=8B=A9=E6=95=B0=E6=8D=AE=E6=BA=90=E5=88=87=E9=9D=A2 */</s=
pan>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicDataSourceAspect</span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> Logger logger =3D Logger.getLogger(DynamicDataSourceAspect.class);

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">pointCut</span><span class=3D"hljs-params" style=3D"col=
or: rgb(102,0,102);">()</span></span>{};

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">before</span><span class=3D"hljs-params" style=3D"color=
: rgb(102,0,102);">(JoinPoint point)</span> </span>{
        Object target =3D point.getTarget();
        String methodName =3D point.getSignature().getName();
        Class&lt;?&gt;[] clazz =3D target.getClass().getInterfaces();
        Class&lt;?&gt;[] parameterTypes =3D ((MethodSignature) point.getSig=
nature()).getMethod().getParameterTypes();
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">try</=
span> {
            Method method =3D clazz[<span class=3D"hljs-number" style=3D"co=
lor: rgb(42,161,152);">0</span>].getMethod(methodName, parameterTypes);
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span> (method !=3D <span class=3D"hljs-keyword" style=3D"color: rgb(133,=
153,0);">null</span> &amp;&amp; method.isAnnotationPresent(DataSource.class=
)) {
                DataSource data =3D method.getAnnotation(DataSource.class);
                DynamicDataSourceHolder.putDataSource(data.value());
            }
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">cat=
ch</span> (Exception e) {
            logger.error(String.format(<span class=3D"hljs-string" style=3D=
"color: rgb(42,161,152);">"Choose DataSource error, method:%s, msg:%s"</spa=
n>, methodName, e.getMessage()));
        }
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">after</span><span class=3D"hljs-params" style=3D"color:=
 rgb(102,0,102);">(JoinPoint point)</span> </span>{
        DynamicDataSourceHolder.clearDataSource();
    }
}</code></pre>
<pre class=3D"hljs xml"><code class=3D"xml"><span class=3D"hljs-pi" style=
=3D"color: rgb(147,161,161);">&lt;?xml version=3D"1.0" encoding=3D"UTF-8"?&=
gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">beans</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">xmlns</span>=3D<span c=
lass=3D"hljs-value" style=3D"color: rgb(42,161,152);">"http://www.springfra=
mework.org/schema/beans"</span> <span class=3D"hljs-attribute" style=3D"col=
or: rgb(181,137,0);">xmlns:xsi</span>=3D<span class=3D"hljs-value" style=3D=
"color: rgb(42,161,152);">"http://www.w3.org/2001/XMLSchema-instance"</span=
> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">xmlns:tx<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"http=
://www.springframework.org/schema/tx"</span> <span class=3D"hljs-attribute"=
 style=3D"color: rgb(181,137,0);">xmlns:aop</span>=3D<span class=3D"hljs-va=
lue" style=3D"color: rgb(42,161,152);">"http://www.springframework.org/sche=
ma/aop"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0=
);">xsi:schemaLocation</span>=3D<span class=3D"hljs-value" style=3D"color: =
rgb(42,161,152);">"http://www.springframework.org/schema/beans http://www.s=
pringframework.org/schema/beans/spring-beans-4.1.xsd http://www.springframe=
work.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.1.x=
sd http://www.springframework.org/schema/aop http://www.springframework.org=
/schema/aop/spring-aop-4.1.xsd"</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstractDataSource"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">abstrac=
t</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"tr=
ue"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
class</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.alibaba.druid.pool.DruidDataSource"</span> <span class=3D"hljs-attrib=
ute" style=3D"color: rgb(181,137,0);">init-method</span>=3D<span class=3D"h=
ljs-value" style=3D"color: rgb(42,161,152);">"init"</span> <span class=3D"h=
ljs-attribute" style=3D"color: rgb(181,137,0);">destroy-method</span>=3D<sp=
an class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"close"</span>&gt=
;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E8=8E=B7=E5=8F=96=E8=BF=9E=E6=8E=A5=E7=AD=89=E5=BE=
=85=E8=B6=85=E6=97=B6=E7=9A=84=E6=97=B6=E9=97=B4 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxWait"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"60000"=
</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E9=97=B4=E9=9A=94=E5=A4=9A=E4=B9=85=E6=89=8D=E8=BF=
=9B=E8=A1=8C=E4=B8=80=E6=AC=A1=E6=A3=80=E6=B5=8B=EF=BC=8C=E6=A3=80=E6=B5=8B=
=E9=9C=80=E8=A6=81=E5=85=B3=E9=97=AD=E7=9A=84=E7=A9=BA=E9=97=B2=E8=BF=9E=E6=
=8E=A5=EF=BC=8C=E5=8D=95=E4=BD=8D=E6=98=AF=E6=AF=AB=E7=A7=92 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"timeBetweenEv=
ictionRunsMillis"</span> <span class=3D"hljs-attribute" style=3D"color: rgb=
(181,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb=
(42,161,152);">"60000"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E4=B8=80=E4=B8=AA=E8=BF=9E=E6=8E=A5=E5=9C=A8=E6=B1=
=A0=E4=B8=AD=E6=9C=80=E5=B0=8F=E7=94=9F=E5=AD=98=E7=9A=84=E6=97=B6=E9=97=B4=
=EF=BC=8C=E5=8D=95=E4=BD=8D=E6=98=AF=E6=AF=AB=E7=A7=92 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minEvictableI=
dleTimeMillis"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(18=
1,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42=
,161,152);">"300000"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"validationQue=
ry"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"SELECT 'x'"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testWhileIdle=
"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">va=
lue</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"=
true"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testOnBorrow"=
</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">val=
ue</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"f=
alse"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testOnReturn"=
</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">val=
ue</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"f=
alse"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E6=89=93=E5=BC=80PSCache=EF=BC=8C=E5=B9=B6=E4=B8=94=E6=8C=87=E5=AE=9A=
=E6=AF=8F=E4=B8=AA=E8=BF=9E=E6=8E=A5=E4=B8=8APSCache=E7=9A=84=E5=A4=A7=E5=
=B0=8F --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"poolPreparedS=
tatements"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,13=
7,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161=
,152);">"true"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxPoolPrepar=
edStatementPerConnectionSize"</span> <span class=3D"hljs-attribute" style=
=3D"color: rgb(181,137,0);">value</span>=3D<span class=3D"hljs-value" style=
=3D"color: rgb(42,161,152);">"20"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"filters"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"config=
"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"connectionPro=
perties"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,=
0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,1=
52);">"config.decrypt=3Dtrue"</span> /&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSourceRead1"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstrac=
tDataSource"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password=
 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read1.jd=
bc.url}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d1.jdbc.user}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d1.jdbc.password}"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=
=81=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${=
read1.jdbc.initPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read=
1.jdbc.minPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${re=
ad1.jdbc.maxPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSourceRead2"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstrac=
tDataSource"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password=
 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read2.jd=
bc.url}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d2.jdbc.user}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d2.jdbc.password}"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=
=81=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${=
read2.jdbc.initPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read=
2.jdbc.minPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${re=
ad2.jdbc.maxPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSourceWrite"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstrac=
tDataSource"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password=
 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${write.jd=
bc.url}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${wri=
te.jdbc.user}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${wri=
te.jdbc.password}"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=
=81=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${=
write.jdbc.initPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${writ=
e.jdbc.minPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${wr=
ite.jdbc.maxPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</span> <spa=
n class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"com.test.api.=
dao.datasource.DynamicDataSource"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"writeDataSour=
ce"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
ref</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"=
dataSourceWrite"</span> /&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"readDataSourc=
es"</span>&gt;</span>
            <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<=
span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">list</span>&gt;=
</span>
                <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&=
lt;<span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">ref</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">bean</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource=
Read1"</span> /&gt;</span>
                <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&=
lt;<span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">ref</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">bean</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource=
Read2"</span> /&gt;</span>
            <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/=
<span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">list</span>&gt=
;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<spa=
n class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span>&gt=
;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!--=E8=BD=AE=E8=AF=A2=E6=96=B9=E5=BC=8F--&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"readDataSourc=
ePollPattern"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181=
,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,=
161,152);">"1"</span> /&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"defaultTarget=
DataSource"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,1=
37,0);">ref</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,=
152);">"dataSourceWrite"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">tx:annotation-driven</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">transa=
ction-manager</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,16=
1,152);">"transactionManager"</span>/&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"transactionManager"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"org.s=
pringframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</sp=
an>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</=
span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataS=
ource"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=92=88=E5=AF=B9myBatis=E7=9A=84=E9=85=8D=E7=BD=AE=E9=A1=B9 --&gt;</span=
>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AEsqlSessionFactory --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"sqlSessionFactory"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"org.my=
batis.spring.SqlSessionFactoryBean"</span>&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=AE=9E=E4=BE=8B=E5=8C=96sqlSessionFactory=E6=97=B6=E9=9C=80=E8=A6=
=81=E4=BD=BF=E7=94=A8=E4=B8=8A=E8=BF=B0=E9=85=8D=E7=BD=AE=E5=A5=BD=E7=9A=84=
=E6=95=B0=E6=8D=AE=E6=BA=90=E4=BB=A5=E5=8F=8ASQL=E6=98=A0=E5=B0=84=E6=96=87=
=E4=BB=B6 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</=
span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataS=
ource"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"mapperLocatio=
ns"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"classpath:mapper/*.xml"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E6=89=AB=E6=8F=8F=E5=99=A8 --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</span>=3D<span c=
lass=3D"hljs-value" style=3D"color: rgb(42,161,152);">"org.mybatis.spring.m=
apper.MapperScannerConfigurer"</span>&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E6=89=AB=E6=8F=8F=E5=8C=85=E4=BB=A5=E5=8F=8A=E5=AE=83=E7=9A=84=E5=AD=
=90=E5=8C=85=E4=B8=8B=E7=9A=84=E6=89=80=E6=9C=89=E6=98=A0=E5=B0=84=E6=8E=A5=
=E5=8F=A3=E7=B1=BB --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"basePackage"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"co=
m.test.api.dao.inte"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"sqlSessionFac=
toryBeanName"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181=
,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,=
161,152);">"sqlSessionFactory"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E6=95=B0=E6=8D=AE=E5=BA=93=E6=B3=A8=E8=A7=A3aop --&gt;<=
/span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dynamicDataSourceAspect=
"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">cl=
ass</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"=
com.test.api.dao.datasource.DynamicDataSourceAspect"</span> /&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">aop:config</span>&gt;</=
span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">aop:aspect</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"c"</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</span>=3D<=
span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dynamicDataSou=
rceAspect"</span>&gt;</span>
            <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<=
span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">aop:pointcut</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"tx"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">express=
ion</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"=
execution(* com.test.api.dao.inte..*.*(..))"</span>/&gt;</span>
            <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<=
span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">aop:before</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">pointcut=
-ref</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">=
"tx"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);"=
>method</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152)=
;">"before"</span>/&gt;</span>
            <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<=
span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">aop:after</span=
> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">pointcut-=
ref</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"=
tx"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
method</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);=
">"after"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<spa=
n class=3D"hljs-title" style=3D"color: rgb(38,139,210);">aop:aspect</span>&=
gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">aop:config</span>&gt;<=
/span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AE=E6=95=B0=E6=8D=AE=E5=BA=93=E6=B3=A8=E8=A7=A3aop --&gt;<=
/span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">beans</span>&gt;</span></=
code></pre>
<h5 id=3D"Spring+MyBatis=E5=AE=9E=E7=8E=B0=E6=95=B0=E6=8D=AE=E5=BA=93=E8=AF=
=BB=E5=86=99=E5=88=86=E7=A6=BB=E6=96=B9=E6=A1=88-=E6=96=B9=E6=A1=883">=E6=
=96=B9=E6=A1=883</h5>
<blockquote style=3D"margin-left: 0.0px;">
<p style=3D"text-align: justify;">=E9=80=9A=E8=BF=87Mybatis=E7=9A=84Plugin=
=E5=9C=A8=E4=B8=9A=E5=8A=A1=E5=B1=82=E5=AE=9E=E7=8E=B0<a href=3D"http://lib=
.csdn.net/base/mysql" title=3D"MySQL=E7=9F=A5=E8=AF=86=E5=BA=93" class=3D"e=
xternal-link" rel=3D"nofollow">=E6=95=B0=E6=8D=AE=E5=BA=93</a>=E8=AF=BB=E5=
=86=99=E5=88=86=E7=A6=BB=EF=BC=8C=E5=9C=A8MyBatis=E5=88=9B=E5=BB=BAStatemen=
t=E5=AF=B9=E8=B1=A1=E5=89=8D=E9=80=9A=E8=BF=87=E6=8B=A6=E6=88=AA=E5=99=A8=
=E9=80=89=E6=8B=A9=E7=9C=9F=E6=AD=A3=E7=9A=84=E6=95=B0=E6=8D=AE=E6=BA=90=EF=
=BC=8C=E5=9C=A8=E6=8B=A6=E6=88=AA=E5=99=A8=E4=B8=AD=E6=A0=B9=E6=8D=AE=E6=96=
=B9=E6=B3=95=E5=90=8D=E7=A7=B0=E4=B8=8D=E5=90=8C=EF=BC=88select=E3=80=81upd=
ate=E3=80=81insert=E3=80=81delete=EF=BC=89=E9=80=89=E6=8B=A9=E6=95=B0=E6=8D=
=AE=E6=BA=90=E3=80=82</p>
</blockquote>
<ul style=3D"text-align: justify;margin-left: 25.0px;">
<li>=E4=BC=98=E7=82=B9=EF=BC=9A=E5=8E=9F=E6=9C=89=E4=BB=A3=E7=A0=81=E4=B8=
=8D=E5=8F=98=EF=BC=8C=E6=94=AF=E6=8C=81=E5=A4=9A=E8=AF=BB=EF=BC=8C=E6=98=93=
=E6=89=A9=E5=B1=95</li>
<li>=E7=BC=BA=E7=82=B9=EF=BC=9A</li>
<li>=E5=AE=9E=E7=8E=B0=E6=96=B9=E5=BC=8F</li>
</ul>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-comment" =
style=3D"color: rgb(147,161,161);">/** * Created by IDEA * User: mashaohua =
* Date: 2016-07-19 15:40 * Desc: =E5=88=9B=E5=BB=BAConnection=E4=BB=A3=E7=
=90=86=E6=8E=A5=E5=8F=A3 */</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">interface</span> <span class=3D"hljs-title" style=3D"color: =
rgb(181,137,0);">ConnectionProxy</span> <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">extends</span> <span class=3D"hljs-title" style=
=3D"color: rgb(181,137,0);">Connection</span> </span>{

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E6=A0=B9=E6=8D=AE=E4=BC=A0=E5=85=A5=E7=9A=84=E8=AF=BB=E5=86=99=E5=88=86=E7=
=A6=BB=E9=9C=80=E8=A6=81=E7=9A=84key=E8=B7=AF=E7=94=B1=E5=88=B0=E6=AD=A3=E7=
=A1=AE=E7=9A=84connection * <span class=3D"hljs-doctag" style=3D"color: rgb=
(42,161,152);">@param</span> key =E6=95=B0=E6=8D=AE=E6=BA=90=E6=A0=87=E8=AF=
=86 * <span class=3D"hljs-doctag" style=3D"color: rgb(42,161,152);">@return=
</span> */</span>
    <span class=3D"hljs-function">Connection <span class=3D"hljs-title" sty=
le=3D"color: rgb(38,139,210);">getTargetConnection</span><span class=3D"hlj=
s-params" style=3D"color: rgb(102,0,102);">(String key)</span></span>;
}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> java.lang.reflect.Invocation=
Handler;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.reflect.InvocationTargetException;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.reflect.Method;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.reflect.Proxy;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.sql.Connection;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.sql.SQLException;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.ArrayList;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.List;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.logging.Logger;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 javax.sql.DataSource;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.springframework.beans.factory.InitializingBean;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.springframework.jdbc.datasource.AbstractDataSource;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.springframework.jdbc.datasource.lookup.DataSourceLookup;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.springframework.jdbc.datasource.lookup.JndiDataSourceLookup;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.springframework.util.Assert;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">abstract</sp=
an> <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color:=
 rgb(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: r=
gb(181,137,0);">AbstractDynamicDataSourceProxy</span> <span class=3D"hljs-k=
eyword" style=3D"color: rgb(133,153,0);">extends</span> <span class=3D"hljs=
-title" style=3D"color: rgb(181,137,0);">AbstractDataSource</span> <span cl=
ass=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">implements</span> <sp=
an class=3D"hljs-title" style=3D"color: rgb(181,137,0);">InitializingBean</=
span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> List&lt;Object&gt; readDataSources;
    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> List&lt;DataSource&gt; resolvedReadDataSources;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> Object writeDataSource;
    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> DataSource resolvedWriteDataSource;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int</sp=
an> readDataSourcePollPattern =3D <span class=3D"hljs-number" style=3D"colo=
r: rgb(42,161,152);">0</span>;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int</sp=
an> readDsSize;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">boolean=
</span> defaultAutoCommit =3D <span class=3D"hljs-keyword" style=3D"color: =
rgb(133,153,0);">true</span>;
    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int</sp=
an> defaultTransactionIsolation =3D Connection.TRANSACTION_READ_COMMITTED;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</s=
pan> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final</=
span> String READ =3D <span class=3D"hljs-string" style=3D"color: rgb(42,16=
1,152);">"read"</span>;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</s=
pan> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final</=
span> String WRITE =3D <span class=3D"hljs-string" style=3D"color: rgb(42,1=
61,152);">"write"</span>;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> DataSourceLookup dataSourceLookup =3D <span class=3D"hljs-keyword" st=
yle=3D"color: rgb(133,153,0);">new</span> JndiDataSourceLookup();

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Connection <span class=3D"hljs-title" st=
yle=3D"color: rgb(38,139,210);">getConnection</span><span class=3D"hljs-par=
ams" style=3D"color: rgb(102,0,102);">()</span> <span class=3D"hljs-keyword=
" style=3D"color: rgb(133,153,0);">throws</span> SQLException </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> (Connection) Proxy.newProxyInstance(
                com.autohome.api.dealer.tuan.dao.rwmybatis.ConnectionProxy.=
class.getClassLoader(),
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">new</span> Class[] {com.autohome.api.dealer.tuan.dao.rwmybatis.Connectio=
nProxy.class},
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">new</span> RWConnectionInvocationHandler());
    }

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Connection <span class=3D"hljs-title" st=
yle=3D"color: rgb(38,139,210);">getConnection</span><span class=3D"hljs-par=
ams" style=3D"color: rgb(102,0,102);">(String username, String password)</s=
pan> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">throws</=
span> SQLException </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> (Connection) Proxy.newProxyInstance(
                com.autohome.api.dealer.tuan.dao.rwmybatis.ConnectionProxy.=
class.getClassLoader(),
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">new</span> Class[] {com.autohome.api.dealer.tuan.dao.rwmybatis.Connectio=
nProxy.class},
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">new</span> RWConnectionInvocationHandler(username,password));
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">int</span> <span class=3D"hljs-title" style=3D"color:=
 rgb(38,139,210);">getReadDsSize</span><span class=3D"hljs-params" style=3D=
"color: rgb(102,0,102);">()</span></span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> readDsSize;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> List&lt;DataSource&gt; <span class=3D"hl=
js-title" style=3D"color: rgb(38,139,210);">getResolvedReadDataSources</spa=
n><span class=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span> </=
span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> resolvedReadDataSources;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">afterPropertiesSet</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">()</span> <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">throws</span> Exception </span>{

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(writeDataSource =3D=3D <span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">null</span>){
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
hrow</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">n=
ew</span> IllegalArgumentException(<span class=3D"hljs-string" style=3D"col=
or: rgb(42,161,152);">"Property 'writeDataSource' is required"</span>);
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.resolvedWriteDataSource =3D resolveSpecifiedDataSource(writeDataSour=
ce);

        resolvedReadDataSources =3D <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">new</span> ArrayList&lt;DataSource&gt;(readDataSourc=
es.size());
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">for</=
span>(Object item : readDataSources){
            resolvedReadDataSources.add(resolveSpecifiedDataSource(item));
        }
        readDsSize =3D readDataSources.size();
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> DataSource <span class=3D"hljs-title"=
 style=3D"color: rgb(38,139,210);">determineTargetDataSource</span><span cl=
ass=3D"hljs-params" style=3D"color: rgb(102,0,102);">(String key)</span> </=
span>{
        Assert.notNull(<span class=3D"hljs-keyword" style=3D"color: rgb(133=
,153,0);">this</span>.resolvedReadDataSources, <span class=3D"hljs-string" =
style=3D"color: rgb(42,161,152);">"DataSource router not initialized"</span=
>);
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(WRITE.equals(key)){
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> resolvedWriteDataSource;
        }<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">else=
</span>{
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> loadReadDataSource();
        }
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Logger <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">getParentLogger</span><span class=3D"hljs-para=
ms" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">// =
NOOP Just ignore</span>
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">null=
</span>;
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E8=8E=B7=E5=8F=96=E7=9C=9F=E5=AE=9E=E7=9A=84data source * <span class=3D"h=
ljs-doctag" style=3D"color: rgb(42,161,152);">@param</span> dataSource (jnd=
i | real data source) * <span class=3D"hljs-doctag" style=3D"color: rgb(42,=
161,152);">@return</span> * <span class=3D"hljs-doctag" style=3D"color: rgb=
(42,161,152);">@throws</span> IllegalArgumentException */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> DataSource <span class=3D"hljs-title"=
 style=3D"color: rgb(38,139,210);">resolveSpecifiedDataSource</span><span c=
lass=3D"hljs-params" style=3D"color: rgb(102,0,102);">(Object dataSource)</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">throws<=
/span> IllegalArgumentException </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (dataSource <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0=
);">instanceof</span> DataSource) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> (DataSource) dataSource;
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">else<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</sp=
an> (dataSource <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">instanceof</span> String) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">=
this</span>.dataSourceLookup.getDataSource((String) dataSource);
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">else<=
/span> {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
hrow</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">n=
ew</span> IllegalArgumentException(
                    <span class=3D"hljs-string" style=3D"color: rgb(42,161,=
152);">"Illegal data source value - only [javax.sql.DataSource] and String =
supported: "</span> + dataSource);
        }
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">abstract</span> DataSource <span class=3D"hljs-tit=
le" style=3D"color: rgb(38,139,210);">loadReadDataSource</span><span class=
=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span></span>;

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setReadDsSize</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" style=3D"color: r=
gb(133,153,0);">int</span> readDsSize)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.readDsSize =3D readDsSize;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> List&lt;Object&gt; <span class=3D"hljs-t=
itle" style=3D"color: rgb(38,139,210);">getReadDataSources</span><span clas=
s=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> readDataSources;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setReadDataSources</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(List&lt;Object&gt; readDataSources)</span> =
</span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.readDataSources =3D readDataSources;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">getWriteDataSource</span><span class=3D"hljs-p=
arams" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> writeDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setWriteDataSource</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(Object writeDataSource)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.writeDataSource =3D writeDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setResolvedReadDataSources</span><span class=3D"hljs-pa=
rams" style=3D"color: rgb(102,0,102);">(List&lt;DataSource&gt; resolvedRead=
DataSources)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.resolvedReadDataSources =3D resolvedReadDataSources;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> DataSource <span class=3D"hljs-title" st=
yle=3D"color: rgb(38,139,210);">getResolvedWriteDataSource</span><span clas=
s=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> resolvedWriteDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setResolvedWriteDataSource</span><span class=3D"hljs-pa=
rams" style=3D"color: rgb(102,0,102);">(DataSource resolvedWriteDataSource)=
</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.resolvedWriteDataSource =3D resolvedWriteDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">int</span> <span class=3D"hljs-title" style=3D"color:=
 rgb(38,139,210);">getReadDataSourcePollPattern</span><span class=3D"hljs-p=
arams" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> readDataSourcePollPattern;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setReadDataSourcePollPattern</span><span class=3D"hljs-=
params" style=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" styl=
e=3D"color: rgb(133,153,0);">int</span> readDataSourcePollPattern)</span> <=
/span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.readDataSourcePollPattern =3D readDataSourcePollPattern;
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * I=
nvocation handler that defers fetching an actual JDBC Connection * until fi=
rst creation of a Statement. */</span>
    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"colo=
r: rgb(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color:=
 rgb(181,137,0);">RWConnectionInvocationHandler</span> <span class=3D"hljs-=
keyword" style=3D"color: rgb(133,153,0);">implements</span> <span class=3D"=
hljs-title" style=3D"color: rgb(181,137,0);">InvocationHandler</span> </spa=
n>{

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">priva=
te</span> String username;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">priva=
te</span> String password;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">priva=
te</span> Boolean readOnly =3D Boolean.FALSE;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">priva=
te</span> Integer transactionIsolation;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">priva=
te</span> Boolean autoCommit;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">priva=
te</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">boo=
lean</span> closed =3D <span class=3D"hljs-keyword" style=3D"color: rgb(133=
,153,0);">false</span>;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">priva=
te</span> Connection target;

        <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">public</span> <span class=3D"hljs-title" style=3D"=
color: rgb(38,139,210);">RWConnectionInvocationHandler</span><span class=3D=
"hljs-params" style=3D"color: rgb(102,0,102);">()</span> </span>{

        }

        <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">public</span> <span class=3D"hljs-title" style=3D"=
color: rgb(38,139,210);">RWConnectionInvocationHandler</span><span class=3D=
"hljs-params" style=3D"color: rgb(102,0,102);">(String username, String pas=
sword)</span> </span>{
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
his</span>();
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
his</span>.username =3D username;
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
his</span>.password =3D password;
        }

        <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" st=
yle=3D"color: rgb(38,139,210);">invoke</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(Object proxy, Method method, Object[] args)=
</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">throw=
s</span> Throwable </span>{
            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>// Invocation on ConnectionProxy interface coming in...</span>

            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"colo=
r: rgb(42,161,152);">"equals"</span>)) {
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// We must avoid fetching a target Connection for "equals".</span>
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// Only consider equal when proxies are identical.</span>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">return</span> (proxy =3D=3D args[<span class=3D"hljs-number" style=3D"co=
lor: rgb(42,161,152);">0</span>] ? Boolean.TRUE : Boolean.FALSE);
            }
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">e=
lse</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if=
</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"color=
: rgb(42,161,152);">"hashCode"</span>)) {
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// We must avoid fetching a target Connection for "hashCode",</span>
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// and we must return the same hash code even when the target</span>
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// Connection has been fetched: use hashCode of Connection proxy.</spa=
n>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0=
);">new</span> Integer(System.identityHashCode(proxy));
            }
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">e=
lse</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if=
</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"color=
: rgb(42,161,152);">"getTargetConnection"</span>)) {
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// Handle getTargetConnection method: return underlying connection.</s=
pan>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">return</span> getTargetConnection(method,args);
            }

            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span> (!hasTargetConnection()) {
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// No physical target Connection kept yet -&gt;</span>
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// resolve transaction demarcation methods without fetching</span>
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// a physical JDBC Connection until absolutely necessary.</span>

                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"=
color: rgb(42,161,152);">"toString"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-string" style=3D"color: rgb(42,161=
,152);">"RW Routing DataSource Proxy"</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"isReadOnly"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">this</span>.readOnly;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"setReadOnly"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">this</span>.readOnly =3D (Boolean) args[<span class=3D"hljs-number" =
style=3D"color: rgb(42,161,152);">0</span>];
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"getTransactionIsolation"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">if</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,=
0);">this</span>.transactionIsolation !=3D <span class=3D"hljs-keyword" sty=
le=3D"color: rgb(133,153,0);">null</span>) {
                        <span class=3D"hljs-keyword" style=3D"color: rgb(13=
3,153,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(1=
33,153,0);">this</span>.transactionIsolation;
                    }
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> defaultTransactionIsolation;
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// Else fetch actual Connection and check there,</span>
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// because we didn't have a default specified.</span>
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"setTransactionIsolation"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">this</span>.transactionIsolation =3D (Integer) args[<span class=3D"h=
ljs-number" style=3D"color: rgb(42,161,152);">0</span>];
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"getAutoCommit"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">if</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,=
0);">this</span>.autoCommit !=3D <span class=3D"hljs-keyword" style=3D"colo=
r: rgb(133,153,0);">null</span>)
                        <span class=3D"hljs-keyword" style=3D"color: rgb(13=
3,153,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(1=
33,153,0);">this</span>.autoCommit;
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> defaultAutoCommit;
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// Else fetch actual Connection and check there,</span>
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// because we didn't have a default specified.</span>
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"setAutoCommit"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">this</span>.autoCommit =3D (Boolean) args[<span class=3D"hljs-number=
" style=3D"color: rgb(42,161,152);">0</span>];
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"commit"</span>)) {
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// Ignore: no statements created yet.</span>
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"rollback"</span>)) {
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// Ignore: no statements created yet.</span>
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"getWarnings"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"clearWarnings"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"isClosed"</span>)) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,=
153,0);">this</span>.closed ? Boolean.TRUE : Boolean.FALSE);
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (method.getName().equals(<span class=3D"hljs-string" style=3D"c=
olor: rgb(42,161,152);">"close"</span>)) {
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// Ignore: no target connection yet.</span>
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">this</span>.closed =3D <span class=3D"hljs-keyword" style=3D"color: =
rgb(133,153,0);">true</span>;
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">return</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">null</span>;
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">else</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">if</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">=
this</span>.closed) {
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// Connection proxy closed, without ever having fetched a</span>
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">// physical JDBC Connection: throw corresponding SQLException.</sp=
an>
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">throw</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">new</span> SQLException(<span class=3D"hljs-string" style=3D"color: =
rgb(42,161,152);">"Illegal operation: connection is closed"</span>);
                }
            }

            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>// Target Connection already fetched,</span>
            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>// or target Connection necessary for current operation -&gt;</span>
            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>// invoke method on target connection.</span>
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
ry</span> {
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">return</span> method.invoke(target, args);
            }
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">c=
atch</span> (InvocationTargetException ex) {
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">throw</span> ex.getTargetException();
            }
        }

        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/**=
 * Return whether the proxy currently holds a target Connection. */</span>
        <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">private</span> <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">boolean</span> <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">hasTargetConnection</span><span class=3D"hljs-=
params" style=3D"color: rgb(102,0,102);">()</span> </span>{
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);"=
>this</span>.target !=3D <span class=3D"hljs-keyword" style=3D"color: rgb(1=
33,153,0);">null</span>);
        }

        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/**=
 * Return the target Connection, fetching it and initializing it if necessa=
ry. */</span>
        <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">private</span> Connection <span class=3D"hljs-titl=
e" style=3D"color: rgb(38,139,210);">getTargetConnection</span><span class=
=3D"hljs-params" style=3D"color: rgb(102,0,102);">(Method operation,Object[=
] args)</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);=
">throws</span> SQLException </span>{

            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">thi=
s</span>.target =3D=3D <span class=3D"hljs-keyword" style=3D"color: rgb(133=
,153,0);">null</span>) {
                String key =3D (String) args[<span class=3D"hljs-number" st=
yle=3D"color: rgb(42,161,152);">0</span>];
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// No target Connection held -&gt; fetch one.</span>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">if</span> (logger.isDebugEnabled()) {
                    logger.debug(<span class=3D"hljs-string" style=3D"color=
: rgb(42,161,152);">"Connecting to database for operation '"</span> + opera=
tion.getName() + <span class=3D"hljs-string" style=3D"color: rgb(42,161,152=
);">"'"</span>);
                }

                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// Fetch physical Connection from DataSource.</span>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">this</span>.target =3D (<span class=3D"hljs-keyword" style=3D"color: rgb=
(133,153,0);">this</span>.username !=3D <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">null</span>) ?
                        determineTargetDataSource(key).getConnection(<span =
class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this</span>.usernam=
e, <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this</span=
>.password) :
                        determineTargetDataSource(key).getConnection();

                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// If we still lack default connection properties, check them now.</sp=
an>
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">//checkDefaultConnectionProperties(this.target);</span>

                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// Apply kept transaction settings, if any.</span>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">if</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);"=
>this</span>.readOnly.booleanValue()) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">this</span>.target.setReadOnly(<span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">this</span>.readOnly.booleanValue());
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">if</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);"=
>this</span>.transactionIsolation !=3D <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">null</span>) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">this</span>.target.setTransactionIsolation(<span class=3D"hljs-keywo=
rd" style=3D"color: rgb(133,153,0);">this</span>.transactionIsolation.intVa=
lue());
                }
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">if</span> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);"=
>this</span>.autoCommit !=3D <span class=3D"hljs-keyword" style=3D"color: r=
gb(133,153,0);">null</span> &amp;&amp; <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">this</span>.autoCommit.booleanValue() !=3D <spa=
n class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this</span>.targe=
t.getAutoCommit()) {
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">this</span>.target.setAutoCommit(<span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">this</span>.autoCommit.booleanValue());
                }
            }

            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">e=
lse</span> {
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">// Target Connection already held -&gt; return it.</span>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">if</span> (logger.isDebugEnabled()) {
                    logger.debug(<span class=3D"hljs-string" style=3D"color=
: rgb(42,161,152);">"Using existing database connection for operation '"</s=
pan> + operation.getName() + <span class=3D"hljs-string" style=3D"color: rg=
b(42,161,152);">"'"</span>);
                }
            }

            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">=
this</span>.target;
        }
    }

}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> javax.sql.DataSource;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.ThreadLocalRandom;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.atomic.AtomicLong;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.locks.Lock;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.locks.ReentrantLock;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * Creat=
ed by IDEA * User: mashaohua * Date: 2016-07-19 16:04 * Desc: */</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicRoutingDataSourceProxy</span> <span class=3D"hljs-keywo=
rd" style=3D"color: rgb(133,153,0);">extends</span> <span class=3D"hljs-tit=
le" style=3D"color: rgb(181,137,0);">AbstractDynamicDataSourceProxy</span> =
</span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> AtomicLong counter =3D <span class=3D"hljs-keyword" style=3D"color: r=
gb(133,153,0);">new</span> AtomicLong(<span class=3D"hljs-number" style=3D"=
color: rgb(42,161,152);">0</span>);

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> Long MAX_POOL =3D Long.MAX_VALUE;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final</=
span> Lock lock =3D <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">new</span> ReentrantLock();

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> DataSource <span class=3D"hljs-title"=
 style=3D"color: rgb(38,139,210);">loadReadDataSource</span><span class=3D"=
hljs-params" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">int</=
span> index =3D <span class=3D"hljs-number" style=3D"color: rgb(42,161,152)=
;">1</span>;

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(getReadDataSourcePollPattern() =3D=3D <span class=3D"hljs-number" styl=
e=3D"color: rgb(42,161,152);">1</span>) {
            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>//=E8=BD=AE=E8=AF=A2=E6=96=B9=E5=BC=8F</span>
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">l=
ong</span> currValue =3D counter.incrementAndGet();
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span>((currValue + <span class=3D"hljs-number" style=3D"color: rgb(42,16=
1,152);">1</span>) &gt;=3D MAX_POOL) {
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">try</span> {
                    lock.lock();
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">if</span>((currValue + <span class=3D"hljs-number" style=3D"color: r=
gb(42,161,152);">1</span>) &gt;=3D MAX_POOL) {
                        counter.set(<span class=3D"hljs-number" style=3D"co=
lor: rgb(42,161,152);">0</span>);
                    }
                } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,=
0);">finally</span> {
                    lock.unlock();
                }
            }
            index =3D (<span class=3D"hljs-keyword" style=3D"color: rgb(133=
,153,0);">int</span>) (currValue % getReadDsSize());
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">els=
e</span> {
            <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);"=
>//=E9=9A=8F=E6=9C=BA=E6=96=B9=E5=BC=8F</span>
            index =3D ThreadLocalRandom.current().nextInt(<span class=3D"hl=
js-number" style=3D"color: rgb(42,161,152);">0</span>, getReadDsSize());
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> getResolvedReadDataSources().get(index);
    }
}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> org.apache.ibatis.executor.s=
tatement.RoutingStatementHandler;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.executor.statement.StatementHandler;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.mapping.MappedStatement;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.mapping.SqlCommandType;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.plugin.*;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.sql.Connection;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.Properties;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =E6=
=8B=A6=E6=88=AA=E5=99=A8 */</span>
<span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Interce=
pts</span>({ <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,15=
7);">@Signature</span>(type =3D StatementHandler.class, method =3D <span cl=
ass=3D"hljs-string" style=3D"color: rgb(42,161,152);">"prepare"</span>, arg=
s =3D { Connection.class }) })
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicPlugin</span> <span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">implements</span> <span class=3D"hljs-title" style=3D"=
color: rgb(181,137,0);">Interceptor</span> </span>{

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">intercept</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(Invocation invocation)</span> <span class=
=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">throws</span> Throwable =
</span>{


        Connection conn =3D (Connection)invocation.getArgs()[<span class=3D=
"hljs-number" style=3D"color: rgb(42,161,152);">0</span>];
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">//=
=E5=A6=82=E6=9E=9C=E6=98=AF=E9=87=87=E7=94=A8=E4=BA=86=E6=88=91=E4=BB=AC=E4=
=BB=A3=E7=90=86,=E5=88=99=E8=B7=AF=E7=94=B1=E6=95=B0=E6=8D=AE=E6=BA=90</spa=
n>
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(conn <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">ins=
tanceof</span> com.autohome.api.dealer.tuan.dao.rwmybatis.ConnectionProxy){
            StatementHandler statementHandler =3D (StatementHandler) invoca=
tion
                    .getTarget();

            MappedStatement mappedStatement =3D <span class=3D"hljs-keyword=
" style=3D"color: rgb(133,153,0);">null</span>;
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span> (statementHandler <span class=3D"hljs-keyword" style=3D"color: rgb=
(133,153,0);">instanceof</span> RoutingStatementHandler) {
                StatementHandler delegate =3D (StatementHandler) Reflection=
Utils
                        .getFieldValue(statementHandler, <span class=3D"hlj=
s-string" style=3D"color: rgb(42,161,152);">"delegate"</span>);
                mappedStatement =3D (MappedStatement) ReflectionUtils.getFi=
eldValue(
                        delegate, <span class=3D"hljs-string" style=3D"colo=
r: rgb(42,161,152);">"mappedStatement"</span>);
            } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);"=
>else</span> {
                mappedStatement =3D (MappedStatement) ReflectionUtils.getFi=
eldValue(
                        statementHandler, <span class=3D"hljs-string" style=
=3D"color: rgb(42,161,152);">"mappedStatement"</span>);
            }
            String key =3D AbstractDynamicDataSourceProxy.WRITE;

            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span>(mappedStatement.getSqlCommandType() =3D=3D SqlCommandType.SELECT){
                key =3D AbstractDynamicDataSourceProxy.READ;
            }<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">=
else</span>{
                key =3D AbstractDynamicDataSourceProxy.WRITE;
            }

            ConnectionProxy connectionProxy =3D (ConnectionProxy)conn;
            connectionProxy.getTargetConnection(key);

        }

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> invocation.proceed();

    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">plugin</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(Object target)</span> </span>{

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> Plugin.wrap(target, <span class=3D"hljs-keyword" style=3D"color: r=
gb(133,153,0);">this</span>);
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setProperties</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(Properties properties)</span> </span>{
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">//N=
OOP</span>

    }

}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> org.apache.ibatis.logging.Lo=
g;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.logging.LogFactory;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.lang.reflect.*;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">ReflectionUtils</span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> Log logger =3D LogFactory.getLog(ReflectionUtils.class);

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E7=9B=B4=E6=8E=A5=E8=AE=BE=E7=BD=AE=E5=AF=B9=E8=B1=A1=E5=B1=9E=E6=80=A7=E5=
=80=BC,=E6=97=A0=E8=A7=86private/protected=E4=BF=AE=E9=A5=B0=E7=AC=A6,=E4=
=B8=8D=E7=BB=8F=E8=BF=87setter=E5=87=BD=E6=95=B0. */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"colo=
r: rgb(38,139,210);">setFieldValue</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" style=3D"color: r=
gb(133,153,0);">final</span> Object object, <span class=3D"hljs-keyword" st=
yle=3D"color: rgb(133,153,0);">final</span> String fieldName, <span class=
=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final</span> Object valu=
e)</span> </span>{
        Field field =3D getDeclaredField(object, fieldName);

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (field =3D=3D <span class=3D"hljs-keyword" style=3D"color: rgb(133,153=
,0);">null</span>)
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
hrow</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">n=
ew</span> IllegalArgumentException(<span class=3D"hljs-string" style=3D"col=
or: rgb(42,161,152);">"Could not find field ["</span> + fieldName + <span c=
lass=3D"hljs-string" style=3D"color: rgb(42,161,152);">"] on target ["</spa=
n> + object + <span class=3D"hljs-string" style=3D"color: rgb(42,161,152);"=
>"]"</span>);

        makeAccessible(field);

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">try</=
span> {
            field.set(object, value);
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">cat=
ch</span> (IllegalAccessException e) {

        }
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E7=9B=B4=E6=8E=A5=E8=AF=BB=E5=8F=96=E5=AF=B9=E8=B1=A1=E5=B1=9E=E6=80=A7=E5=
=80=BC,=E6=97=A0=E8=A7=86private/protected=E4=BF=AE=E9=A5=B0=E7=AC=A6,=E4=
=B8=8D=E7=BB=8F=E8=BF=87getter=E5=87=BD=E6=95=B0. */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">getFieldValue</span><span class=3D"hljs-params=
" style=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">final</span> Object object, <span class=3D"hljs-keyw=
ord" style=3D"color: rgb(133,153,0);">final</span> String fieldName)</span>=
 </span>{
        Field field =3D getDeclaredField(object, fieldName);

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (field =3D=3D <span class=3D"hljs-keyword" style=3D"color: rgb(133,153=
,0);">null</span>)
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
hrow</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">n=
ew</span> IllegalArgumentException(<span class=3D"hljs-string" style=3D"col=
or: rgb(42,161,152);">"Could not find field ["</span> + fieldName + <span c=
lass=3D"hljs-string" style=3D"color: rgb(42,161,152);">"] on target ["</spa=
n> + object + <span class=3D"hljs-string" style=3D"color: rgb(42,161,152);"=
>"]"</span>);

        makeAccessible(field);

        Object result =3D <span class=3D"hljs-keyword" style=3D"color: rgb(=
133,153,0);">null</span>;
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">try</=
span> {
            result =3D field.get(object);
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">cat=
ch</span> (IllegalAccessException e) {

        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> result;
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E7=9B=B4=E6=8E=A5=E8=B0=83=E7=94=A8=E5=AF=B9=E8=B1=A1=E6=96=B9=E6=B3=95,=
=E6=97=A0=E8=A7=86private/protected=E4=BF=AE=E9=A5=B0=E7=AC=A6. */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">invokeMethod</span><span class=3D"hljs-params"=
 style=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">final</span> Object object, <span class=3D"hljs-keywo=
rd" style=3D"color: rgb(133,153,0);">final</span> String methodName, <span =
class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final</span> Class&=
lt;?&gt;[] parameterTypes, <span class=3D"hljs-keyword" style=3D"color: rgb=
(133,153,0);">final</span> Object[] parameters)</span> <span class=3D"hljs-=
keyword" style=3D"color: rgb(133,153,0);">throws</span> InvocationTargetExc=
eption </span>{
        Method method =3D getDeclaredMethod(object, methodName, parameterTy=
pes);
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (method =3D=3D <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">null</span>)
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
hrow</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">n=
ew</span> IllegalArgumentException(<span class=3D"hljs-string" style=3D"col=
or: rgb(42,161,152);">"Could not find method ["</span> + methodName + <span=
 class=3D"hljs-string" style=3D"color: rgb(42,161,152);">"] on target ["</s=
pan> + object + <span class=3D"hljs-string" style=3D"color: rgb(42,161,152)=
;">"]"</span>);

        method.setAccessible(<span class=3D"hljs-keyword" style=3D"color: r=
gb(133,153,0);">true</span>);

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">try</=
span> {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> method.invoke(object, parameters);
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">cat=
ch</span> (IllegalAccessException e) {

        }

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">null=
</span>;
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E5=BE=AA=E7=8E=AF=E5=90=91=E4=B8=8A=E8=BD=AC=E5=9E=8B,=E8=8E=B7=E5=8F=96=
=E5=AF=B9=E8=B1=A1=E7=9A=84DeclaredField. */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">static</span> Field <span class=3D"hljs-title" sty=
le=3D"color: rgb(38,139,210);">getDeclaredField</span><span class=3D"hljs-p=
arams" style=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">final</span> Object object, <span class=3D"hljs=
-keyword" style=3D"color: rgb(133,153,0);">final</span> String fieldName)</=
span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">for</=
span> (Class&lt;?&gt; superClass =3D object.getClass(); superClass !=3D Obj=
ect.class; superClass =3D superClass
                .getSuperclass()) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
ry</span> {
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">return</span> superClass.getDeclaredField(fieldName);
            } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);"=
>catch</span> (NoSuchFieldException e) {
            }
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">null=
</span>;
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E5=BE=AA=E7=8E=AF=E5=90=91=E4=B8=8A=E8=BD=AC=E5=9E=8B,=E8=8E=B7=E5=8F=96=
=E5=AF=B9=E8=B1=A1=E7=9A=84DeclaredField. */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">static</span> <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D=
"color: rgb(38,139,210);">makeAccessible</span><span class=3D"hljs-params" =
style=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">final</span> Field field)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (!Modifier.isPublic(field.getModifiers()) || !Modifier.isPublic(field.=
getDeclaringClass().getModifiers())) {
            field.setAccessible(<span class=3D"hljs-keyword" style=3D"color=
: rgb(133,153,0);">true</span>);
        }
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E5=BE=AA=E7=8E=AF=E5=90=91=E4=B8=8A=E8=BD=AC=E5=9E=8B,=E8=8E=B7=E5=8F=96=
=E5=AF=B9=E8=B1=A1=E7=9A=84DeclaredMethod. */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">static</span> Method <span class=3D"hljs-title" st=
yle=3D"color: rgb(38,139,210);">getDeclaredMethod</span><span class=3D"hljs=
-params" style=3D"color: rgb(102,0,102);">(Object object, String methodName=
, Class&lt;?&gt;[] parameterTypes)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">for</=
span> (Class&lt;?&gt; superClass =3D object.getClass(); superClass !=3D Obj=
ect.class; superClass =3D superClass
                .getSuperclass()) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
ry</span> {
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">return</span> superClass.getDeclaredMethod(methodName, parameterTypes);
            } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);"=
>catch</span> (NoSuchMethodException e) {

            }
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">null=
</span>;
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E9=80=9A=E8=BF=87=E5=8F=8D=E5=B0=84,=E8=8E=B7=E5=BE=97Class=E5=AE=9A=E4=B9=
=89=E4=B8=AD=E5=A3=B0=E6=98=8E=E7=9A=84=E7=88=B6=E7=B1=BB=E7=9A=84=E6=B3=9B=
=E5=9E=8B=E5=8F=82=E6=95=B0=E7=9A=84=E7=B1=BB=E5=9E=8B. * eg. * public User=
Dao extends HibernateDao&lt;User&gt; * * <span class=3D"hljs-doctag" style=
=3D"color: rgb(42,161,152);">@param</span> clazz The class to introspect * =
<span class=3D"hljs-doctag" style=3D"color: rgb(42,161,152);">@return</span=
> the first generic declaration, or Object.class if cannot be determined */=
</span>
    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Sup=
pressWarnings</span>(<span class=3D"hljs-string" style=3D"color: rgb(42,161=
,152);">"unchecked"</span>)
    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</s=
pan> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static</=
span> &lt;T&gt; <span class=3D"hljs-function">Class&lt;T&gt; <span class=3D=
"hljs-title" style=3D"color: rgb(38,139,210);">getSuperClassGenricType</spa=
n><span class=3D"hljs-params" style=3D"color: rgb(102,0,102);">(<span class=
=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final</span> Class clazz=
)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> getSuperClassGenricType(clazz, <span class=3D"hljs-number" style=
=3D"color: rgb(42,161,152);">0</span>);
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E9=80=9A=E8=BF=87=E5=8F=8D=E5=B0=84,=E8=8E=B7=E5=BE=97Class=E5=AE=9A=E4=B9=
=89=E4=B8=AD=E5=A3=B0=E6=98=8E=E7=9A=84=E7=88=B6=E7=B1=BB=E7=9A=84=E6=B3=9B=
=E5=9E=8B=E5=8F=82=E6=95=B0=E7=9A=84=E7=B1=BB=E5=9E=8B. * eg. * public User=
Dao extends HibernateDao&lt;User&gt; * * <span class=3D"hljs-doctag" style=
=3D"color: rgb(42,161,152);">@param</span> clazz The class to introspect * =
<span class=3D"hljs-doctag" style=3D"color: rgb(42,161,152);">@return</span=
> the first generic declaration, or Object.class if cannot be determined */=
</span>
    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Sup=
pressWarnings</span>(<span class=3D"hljs-string" style=3D"color: rgb(42,161=
,152);">"unchecked"</span>)
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> Class <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">getSuperClassGenricType</span><span class=3D"h=
ljs-params" style=3D"color: rgb(102,0,102);">(<span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">final</span> Class clazz, <span class=3D"h=
ljs-keyword" style=3D"color: rgb(133,153,0);">final</span> <span class=3D"h=
ljs-keyword" style=3D"color: rgb(133,153,0);">int</span> index)</span> </sp=
an>{

        Type genType =3D clazz.getGenericSuperclass();

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (!(genType <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">instanceof</span> ParameterizedType)) {
            logger.warn(clazz.getSimpleName() + <span class=3D"hljs-string"=
 style=3D"color: rgb(42,161,152);">"'s superclass not ParameterizedType"</s=
pan>);
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> Object.class;
        }

        Type[] params =3D ((ParameterizedType) genType).getActualTypeArgume=
nts();

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (index &gt;=3D params.length || index &lt; <span class=3D"hljs-number"=
 style=3D"color: rgb(42,161,152);">0</span>) {
            logger.warn(<span class=3D"hljs-string" style=3D"color: rgb(42,=
161,152);">"Index: "</span> + index + <span class=3D"hljs-string" style=3D"=
color: rgb(42,161,152);">", Size of "</span> + clazz.getSimpleName() + <spa=
n class=3D"hljs-string" style=3D"color: rgb(42,161,152);">"'s Parameterized=
 Type: "</span>
                    + params.length);
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> Object.class;
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (!(params[index] <span class=3D"hljs-keyword" style=3D"color: rgb(133,=
153,0);">instanceof</span> Class)) {
            logger.warn(clazz.getSimpleName() + <span class=3D"hljs-string"=
 style=3D"color: rgb(42,161,152);">" not set the actual class on superclass=
 generic parameter"</span>);
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> Object.class;
        }

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> (Class) params[index];
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E5=B0=86=E5=8F=8D=E5=B0=84=E6=97=B6=E7=9A=84checked exception=E8=BD=AC=E6=
=8D=A2=E4=B8=BAunchecked exception. */</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> IllegalArgumentException <span class=3D=
"hljs-title" style=3D"color: rgb(38,139,210);">convertToUncheckedException<=
/span><span class=3D"hljs-params" style=3D"color: rgb(102,0,102);">(Excepti=
on e)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (e <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">insta=
nceof</span> IllegalAccessException || e <span class=3D"hljs-keyword" style=
=3D"color: rgb(133,153,0);">instanceof</span> IllegalArgumentException
                || e <span class=3D"hljs-keyword" style=3D"color: rgb(133,1=
53,0);">instanceof</span> NoSuchMethodException)
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">=
new</span> IllegalArgumentException(<span class=3D"hljs-string" style=3D"co=
lor: rgb(42,161,152);">"Refelction Exception."</span>, e);
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">else<=
/span>
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">=
new</span> IllegalArgumentException(e);
    }
}</code></pre>
<pre class=3D"hljs xml"><code class=3D"xml"><span class=3D"hljs-pi" style=
=3D"color: rgb(147,161,161);">&lt;?xml version=3D"1.0" encoding=3D"UTF-8"?&=
gt;</span>
<span class=3D"hljs-doctype" style=3D"color: rgb(147,161,161);">&lt;!DOCTYP=
E configuration PUBLIC "-//mybatis.org//DTD SQL Map Config 3.0//EN" "http:/=
/mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">configuration</span>&gt;<=
/span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">plugins</span>&gt;</spa=
n>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">plugin</span> <span=
 class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">interceptor</spa=
n>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"com.test=
.api.dao.mybatis.DynamicPlugin"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<spa=
n class=3D"hljs-title" style=3D"color: rgb(38,139,210);">plugin</span>&gt;<=
/span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">plugins</span>&gt;</sp=
an>

<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">configuration</span>&gt;<=
/span></code></pre>
<pre class=3D"hljs xml"><code class=3D"xml"><span class=3D"hljs-pi" style=
=3D"color: rgb(147,161,161);">&lt;?xml version=3D"1.0" encoding=3D"UTF-8"?&=
gt;</span>
<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">beans</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">xmlns</span>=3D<span c=
lass=3D"hljs-value" style=3D"color: rgb(42,161,152);">"http://www.springfra=
mework.org/schema/beans"</span> <span class=3D"hljs-attribute" style=3D"col=
or: rgb(181,137,0);">xmlns:xsi</span>=3D<span class=3D"hljs-value" style=3D=
"color: rgb(42,161,152);">"http://www.w3.org/2001/XMLSchema-instance"</span=
> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">xmlns:tx<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"http=
://www.springframework.org/schema/tx"</span> <span class=3D"hljs-attribute"=
 style=3D"color: rgb(181,137,0);">xmlns:aop</span>=3D<span class=3D"hljs-va=
lue" style=3D"color: rgb(42,161,152);">"http://www.springframework.org/sche=
ma/aop"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0=
);">xsi:schemaLocation</span>=3D<span class=3D"hljs-value" style=3D"color: =
rgb(42,161,152);">"http://www.springframework.org/schema/beans http://www.s=
pringframework.org/schema/beans/spring-beans-4.1.xsd http://www.springframe=
work.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.1.x=
sd http://www.springframework.org/schema/aop http://www.springframework.org=
/schema/aop/spring-aop-4.1.xsd"</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstractDataSource"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">abstrac=
t</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"tr=
ue"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
class</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.alibaba.druid.pool.DruidDataSource"</span> <span class=3D"hljs-attrib=
ute" style=3D"color: rgb(181,137,0);">init-method</span>=3D<span class=3D"h=
ljs-value" style=3D"color: rgb(42,161,152);">"init"</span> <span class=3D"h=
ljs-attribute" style=3D"color: rgb(181,137,0);">destroy-method</span>=3D<sp=
an class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"close"</span>&gt=
;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E8=8E=B7=E5=8F=96=E8=BF=9E=E6=8E=A5=E7=AD=89=E5=BE=
=85=E8=B6=85=E6=97=B6=E7=9A=84=E6=97=B6=E9=97=B4 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxWait"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"60000"=
</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E9=97=B4=E9=9A=94=E5=A4=9A=E4=B9=85=E6=89=8D=E8=BF=
=9B=E8=A1=8C=E4=B8=80=E6=AC=A1=E6=A3=80=E6=B5=8B=EF=BC=8C=E6=A3=80=E6=B5=8B=
=E9=9C=80=E8=A6=81=E5=85=B3=E9=97=AD=E7=9A=84=E7=A9=BA=E9=97=B2=E8=BF=9E=E6=
=8E=A5=EF=BC=8C=E5=8D=95=E4=BD=8D=E6=98=AF=E6=AF=AB=E7=A7=92 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"timeBetweenEv=
ictionRunsMillis"</span> <span class=3D"hljs-attribute" style=3D"color: rgb=
(181,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb=
(42,161,152);">"60000"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E4=B8=80=E4=B8=AA=E8=BF=9E=E6=8E=A5=E5=9C=A8=E6=B1=
=A0=E4=B8=AD=E6=9C=80=E5=B0=8F=E7=94=9F=E5=AD=98=E7=9A=84=E6=97=B6=E9=97=B4=
=EF=BC=8C=E5=8D=95=E4=BD=8D=E6=98=AF=E6=AF=AB=E7=A7=92 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minEvictableI=
dleTimeMillis"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(18=
1,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42=
,161,152);">"300000"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"validationQue=
ry"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"SELECT 'x'"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testWhileIdle=
"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">va=
lue</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"=
true"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testOnBorrow"=
</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">val=
ue</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"f=
alse"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"testOnReturn"=
</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">val=
ue</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"f=
alse"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E6=89=93=E5=BC=80PSCache=EF=BC=8C=E5=B9=B6=E4=B8=94=E6=8C=87=E5=AE=9A=
=E6=AF=8F=E4=B8=AA=E8=BF=9E=E6=8E=A5=E4=B8=8APSCache=E7=9A=84=E5=A4=A7=E5=
=B0=8F --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"poolPreparedS=
tatements"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,13=
7,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161=
,152);">"true"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxPoolPrepar=
edStatementPerConnectionSize"</span> <span class=3D"hljs-attribute" style=
=3D"color: rgb(181,137,0);">value</span>=3D<span class=3D"hljs-value" style=
=3D"color: rgb(42,161,152);">"20"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"filters"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"config=
"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"connectionPro=
perties"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,=
0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,1=
52);">"config.decrypt=3Dtrue"</span> /&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSourceRead1"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstrac=
tDataSource"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password=
 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read1.jd=
bc.url}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d1.jdbc.user}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d1.jdbc.password}"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=
=81=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${=
read1.jdbc.initPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read=
1.jdbc.minPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${re=
ad1.jdbc.maxPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSourceRead2"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstrac=
tDataSource"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password=
 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read2.jd=
bc.url}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d2.jdbc.user}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${rea=
d2.jdbc.password}"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=
=81=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${=
read2.jdbc.initPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${read=
2.jdbc.minPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${re=
ad2.jdbc.maxPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSourceWrite"</span>=
 <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">parent</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"abstrac=
tDataSource"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"driverClassNa=
me"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=9F=BA=E6=9C=AC=E5=B1=9E=E6=80=A7 url=E3=80=81user=E3=80=81password=
 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"url"</span> <=
span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${write.jd=
bc.url}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"username"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${wri=
te.jdbc.user}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"password"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${wri=
te.jdbc.password}"</span>/&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E9=85=8D=E7=BD=AE=E5=88=9D=E5=A7=8B=E5=8C=96=E5=A4=A7=E5=B0=8F=E3=80=
=81=E6=9C=80=E5=B0=8F=E3=80=81=E6=9C=80=E5=A4=A7 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"initialSize"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${=
write.jdbc.initPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"minIdle"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${writ=
e.jdbc.minPoolSize}"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"maxActive"</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">value<=
/span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"${wr=
ite.jdbc.maxPoolSize}"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</span> <spa=
n class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"com.test.api.=
dao.datasource.DynamicRoutingDataSourceProxy"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"writeDataSour=
ce"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
ref</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"=
dataSourceWrite"</span> /&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"readDataSourc=
es"</span>&gt;</span>
            <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<=
span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">list</span>&gt;=
</span>
                <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&=
lt;<span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">ref</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">bean</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource=
Read1"</span> /&gt;</span>
                <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&=
lt;<span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">ref</span> =
<span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">bean</span>=
=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource=
Read2"</span> /&gt;</span>
            <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/=
<span class=3D"hljs-title" style=3D"color: rgb(38,139,210);">list</span>&gt=
;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<spa=
n class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span>&gt=
;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!--=E8=BD=AE=E8=AF=A2=E6=96=B9=E5=BC=8F--&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"readDataSourc=
ePollPattern"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181=
,137,0);">value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,=
161,152);">"1"</span> /&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">tx:annotation-driven</s=
pan> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">transa=
ction-manager</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,16=
1,152);">"transactionManager"</span>/&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"transactionManager"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"org.s=
pringframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</sp=
an>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</=
span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataS=
ource"</span>/&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=92=88=E5=AF=B9myBatis=E7=9A=84=E9=85=8D=E7=BD=AE=E9=A1=B9 --&gt;</span=
>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=85=8D=E7=BD=AEsqlSessionFactory --&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"sqlSessionFactory"</spa=
n> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</s=
pan>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"org.my=
batis.spring.SqlSessionFactoryBean"</span>&gt;</span>
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt=
;!-- =E5=AE=9E=E4=BE=8B=E5=8C=96sqlSessionFactory=E6=97=B6=E9=9C=80=E8=A6=
=81=E4=BD=BF=E7=94=A8=E4=B8=8A=E8=BF=B0=E9=85=8D=E7=BD=AE=E5=A5=BD=E7=9A=84=
=E6=95=B0=E6=8D=AE=E6=BA=90=E4=BB=A5=E5=8F=8ASQL=E6=98=A0=E5=B0=84=E6=96=87=
=E4=BB=B6 --&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataSource"</=
span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"dataS=
ource"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"mapperLocatio=
ns"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">=
value</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);"=
>"classpath:mapper/*.xml"</span>/&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"configLocatio=
n"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">v=
alue</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">=
"classpath:mybatis-plugin-config.xml"</span> /&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"sqlSessionTemplate"</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</=
span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"org.m=
ybatis.spring.SqlSessionTemplate"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">constructor-arg</sp=
an> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">ref</sp=
an>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"sqlSess=
ionFactory"</span> /&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>
    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">&lt;!--=
 =E9=80=9A=E8=BF=87=E6=89=AB=E6=8F=8F=E7=9A=84=E6=A8=A1=E5=BC=8F=EF=BC=8C=
=E6=89=AB=E6=8F=8F=E7=9B=AE=E5=BD=95=E4=B8=8B=E6=89=80=E6=9C=89=E7=9A=84map=
per=EF=BC=8C =E6=A0=B9=E6=8D=AE=E5=AF=B9=E5=BA=94=E7=9A=84mapper.xml=E4=B8=
=BA=E5=85=B6=E7=94=9F=E6=88=90=E4=BB=A3=E7=90=86=E7=B1=BB--&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span cla=
ss=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span> <span class=
=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">id</span>=3D<span clas=
s=3D"hljs-value" style=3D"color: rgb(42,161,152);">"mapper"</span> <span cl=
ass=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">class</span>=3D<spa=
n class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"org.mybatis.sprin=
g.mapper.MapperScannerConfigurer"</span>&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"basePackage"<=
/span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">valu=
e</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"co=
m.test.api.dao.inte"</span> /&gt;</span>
        <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;<span=
 class=3D"hljs-title" style=3D"color: rgb(38,139,210);">property</span> <sp=
an class=3D"hljs-attribute" style=3D"color: rgb(181,137,0);">name</span>=3D=
<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);">"sqlSessionTem=
plate"</span> <span class=3D"hljs-attribute" style=3D"color: rgb(181,137,0)=
;">ref</span>=3D<span class=3D"hljs-value" style=3D"color: rgb(42,161,152);=
">"sqlSessionTemplate"</span>&gt;</span><span class=3D"hljs-tag" style=3D"c=
olor: rgb(0,102,102);">&lt;/<span class=3D"hljs-title" style=3D"color: rgb(=
38,139,210);">property</span>&gt;</span>
    <span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span cl=
ass=3D"hljs-title" style=3D"color: rgb(38,139,210);">bean</span>&gt;</span>

<span class=3D"hljs-tag" style=3D"color: rgb(0,102,102);">&lt;/<span class=
=3D"hljs-title" style=3D"color: rgb(38,139,210);">beans</span>&gt;</span></=
code></pre>
<h5 id=3D"Spring+MyBatis=E5=AE=9E=E7=8E=B0=E6=95=B0=E6=8D=AE=E5=BA=93=E8=AF=
=BB=E5=86=99=E5=88=86=E7=A6=BB=E6=96=B9=E6=A1=88-=E6=96=B9=E6=A1=884">=E6=
=96=B9=E6=A1=884</h5>
<blockquote style=3D"margin-left: 0.0px;">
<p style=3D"text-align: justify;">=E5=A6=82=E6=9E=9C=E4=BD=A0=E7=9A=84=E5=
=90=8E=E5=8F=B0=E7=BB=93=E6=9E=84=E6=98=AFspring+mybatis=EF=BC=8C=E5=8F=AF=
=E4=BB=A5=E9=80=9A=E8=BF=87spring=E7=9A=84AbstractRoutingDataSource=E5=92=
=8Cmybatis Plugin=E6=8B=A6=E6=88=AA=E5=99=A8=E5=AE=9E=E7=8E=B0=E9=9D=9E=E5=
=B8=B8=E5=8F=8B=E5=A5=BD=E7=9A=84=E8=AF=BB=E5=86=99=E5=88=86=E7=A6=BB=EF=BC=
=8C=E5=8E=9F=E6=9C=89=E4=BB=A3=E7=A0=81=E4=B8=8D=E9=9C=80=E8=A6=81=E4=BB=BB=
=E4=BD=95=E6=94=B9=E5=8F=98=E3=80=82=E6=8E=A8=E8=8D=90=E7=AC=AC=E5=9B=9B=E7=
=A7=8D=E6=96=B9=E6=A1=88</p>
</blockquote>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> org.springframework.jdbc.dat=
asource.lookup.AbstractRoutingDataSource;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.HashMap;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.Map;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * Creat=
ed by IDEA * User: mashaohua * Date: 2016-07-14 10:56 * Desc: =E5=8A=A8=E6=
=80=81=E6=95=B0=E6=8D=AE=E6=BA=90=E5=AE=9E=E7=8E=B0=E8=AF=BB=E5=86=99=E5=88=
=86=E7=A6=BB */</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicDataSource</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">extends</span> <span class=3D"hljs-title" style=3D=
"color: rgb(181,137,0);">AbstractRoutingDataSource</span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> Object writeDataSource; <span class=3D"hljs-comment" style=3D"color: =
rgb(147,161,161);">//=E5=86=99=E6=95=B0=E6=8D=AE=E6=BA=90</span>

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> Object readDataSource; <span class=3D"hljs-comment" style=3D"color: r=
gb(147,161,161);">//=E8=AF=BB=E6=95=B0=E6=8D=AE=E6=BA=90</span>

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">afterPropertiesSet</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this</s=
pan>.writeDataSource =3D=3D <span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">null</span>) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">t=
hrow</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">n=
ew</span> IllegalArgumentException(<span class=3D"hljs-string" style=3D"col=
or: rgb(42,161,152);">"Property 'writeDataSource' is required"</span>);
        }
        setDefaultTargetDataSource(writeDataSource);
        Map&lt;Object, Object&gt; targetDataSources =3D <span class=3D"hljs=
-keyword" style=3D"color: rgb(133,153,0);">new</span> HashMap&lt;&gt;();
        targetDataSources.put(DynamicDataSourceGlobal.WRITE.name(), writeDa=
taSource);
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(readDataSource !=3D <span class=3D"hljs-keyword" style=3D"color: rgb(1=
33,153,0);">null</span>) {
            targetDataSources.put(DynamicDataSourceGlobal.READ.name(), read=
DataSource);
        }
        setTargetDataSources(targetDataSources);
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">super=
</span>.afterPropertiesSet();
    }

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> Object <span class=3D"hljs-title" sty=
le=3D"color: rgb(38,139,210);">determineCurrentLookupKey</span><span class=
=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span> </span>{

        DynamicDataSourceGlobal dynamicDataSourceGlobal =3D DynamicDataSour=
ceHolder.getDataSource();

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(dynamicDataSourceGlobal =3D=3D <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">null</span>
                || dynamicDataSourceGlobal =3D=3D DynamicDataSourceGlobal.W=
RITE) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> DynamicDataSourceGlobal.WRITE.name();
        }

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> DynamicDataSourceGlobal.READ.name();
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setWriteDataSource</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(Object writeDataSource)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.writeDataSource =3D writeDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">getWriteDataSource</span><span class=3D"hljs-p=
arams" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> writeDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">getReadDataSource</span><span class=3D"hljs-pa=
rams" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> readDataSource;
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setReadDataSource</span><span class=3D"hljs-params" sty=
le=3D"color: rgb(102,0,102);">(Object readDataSource)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">this<=
/span>.readDataSource =3D readDataSource;
    }
}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-comment" =
style=3D"color: rgb(147,161,161);">/** * Created by IDEA * User: mashaohua =
* Date: 2016-07-14 10:58 * Desc: */</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">enum</span> =
DynamicDataSourceGlobal {
    READ, WRITE;
}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword"=
 style=3D"color: rgb(133,153,0);">final</span> <span class=3D"hljs-class"><=
span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">class</span> <=
span class=3D"hljs-title" style=3D"color: rgb(181,137,0);">DynamicDataSourc=
eHolder</span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> ThreadLocal&lt;DynamicDataSourceGlobal&gt; holder =3D <span class=3D=
"hljs-keyword" style=3D"color: rgb(133,153,0);">new</span> ThreadLocal&lt;D=
ynamicDataSourceGlobal&gt;();

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">private</span> <span class=3D"hljs-title" style=3D"col=
or: rgb(38,139,210);">DynamicDataSourceHolder</span><span class=3D"hljs-par=
ams" style=3D"color: rgb(102,0,102);">()</span> </span>{
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">//<=
/span>
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"colo=
r: rgb(38,139,210);">putDataSource</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(DynamicDataSourceGlobal dataSource)</span></sp=
an>{
        holder.set(dataSource);
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> DynamicDataSourceGlobal <span class=3D"=
hljs-title" style=3D"color: rgb(38,139,210);">getDataSource</span><span cla=
ss=3D"hljs-params" style=3D"color: rgb(102,0,102);">()</span></span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> holder.get();
    }

    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">static</span> <span class=3D"hljs-keyword" style=3D"c=
olor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"colo=
r: rgb(38,139,210);">clearDataSource</span><span class=3D"hljs-params" styl=
e=3D"color: rgb(102,0,102);">()</span> </span>{
        holder.remove();
    }

}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> org.springframework.jdbc.dat=
asource.DataSourceTransactionManager;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.springframework.transaction.TransactionDefinition;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * Creat=
ed by IDEA * User: mashaohua * Date: 2016-08-10 14:34 * Desc: */</span>
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicDataSourceTransactionManager</span> <span class=3D"hljs=
-keyword" style=3D"color: rgb(133,153,0);">extends</span> <span class=3D"hl=
js-title" style=3D"color: rgb(181,137,0);">DataSourceTransactionManager</sp=
an> </span>{

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E5=8F=AA=E8=AF=BB=E4=BA=8B=E5=8A=A1=E5=88=B0=E8=AF=BB=E5=BA=93=EF=BC=8C=E8=
=AF=BB=E5=86=99=E4=BA=8B=E5=8A=A1=E5=88=B0=E5=86=99=E5=BA=93 * <span class=
=3D"hljs-doctag" style=3D"color: rgb(42,161,152);">@param</span> transactio=
n * <span class=3D"hljs-doctag" style=3D"color: rgb(42,161,152);">@param</s=
pan> definition */</span>
    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"co=
lor: rgb(38,139,210);">doBegin</span><span class=3D"hljs-params" style=3D"c=
olor: rgb(102,0,102);">(Object transaction, TransactionDefinition definitio=
n)</span> </span>{

        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">//=
=E8=AE=BE=E7=BD=AE=E6=95=B0=E6=8D=AE=E6=BA=90</span>
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">boole=
an</span> readOnly =3D definition.isReadOnly();
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(readOnly) {
            DynamicDataSourceHolder.putDataSource(DynamicDataSourceGlobal.R=
EAD);
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">els=
e</span> {
            DynamicDataSourceHolder.putDataSource(DynamicDataSourceGlobal.W=
RITE);
        }
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">super=
</span>.doBegin(transaction, definition);
    }

    <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * =
=E6=B8=85=E7=90=86=E6=9C=AC=E5=9C=B0=E7=BA=BF=E7=A8=8B=E7=9A=84=E6=95=B0=E6=
=8D=AE=E6=BA=90 * <span class=3D"hljs-doctag" style=3D"color: rgb(42,161,15=
2);">@param</span> transaction */</span>
    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">protected</span> <span class=3D"hljs-keyword" style=3D=
"color: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"co=
lor: rgb(38,139,210);">doCleanupAfterCompletion</span><span class=3D"hljs-p=
arams" style=3D"color: rgb(102,0,102);">(Object transaction)</span> </span>=
{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">super=
</span>.doCleanupAfterCompletion(transaction);
        DynamicDataSourceHolder.clearDataSource();
    }
}</code></pre>
<pre class=3D"hljs java"><code class=3D"java"><span class=3D"hljs-keyword" =
style=3D"color: rgb(133,153,0);">import</span> org.apache.ibatis.executor.E=
xecutor;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.executor.keygen.SelectKeyGenerator;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.mapping.BoundSql;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.mapping.MappedStatement;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.mapping.SqlCommandType;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.plugin.*;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.session.ResultHandler;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.apache.ibatis.session.RowBounds;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.slf4j.Logger;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.slf4j.LoggerFactory;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 org.springframework.transaction.support.TransactionSynchronizationManager;

<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.Locale;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.Map;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.Properties;
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">import</span>=
 java.util.concurrent.ConcurrentHashMap;

<span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">/** * Creat=
ed by IDEA * User: mashaohua * Date: 2016-08-10 11:09 * Desc: */</span>
<span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Interce=
pts</span>({
<span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Signatu=
re</span>(type =3D Executor.class, method =3D <span class=3D"hljs-string" s=
tyle=3D"color: rgb(42,161,152);">"update"</span>, args =3D {
        MappedStatement.class, Object.class }),
<span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Signatu=
re</span>(type =3D Executor.class, method =3D <span class=3D"hljs-string" s=
tyle=3D"color: rgb(42,161,152);">"query"</span>, args =3D {
        MappedStatement.class, Object.class, RowBounds.class,
        ResultHandler.class }) })
<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">public</span>=
 <span class=3D"hljs-class"><span class=3D"hljs-keyword" style=3D"color: rg=
b(133,153,0);">class</span> <span class=3D"hljs-title" style=3D"color: rgb(=
181,137,0);">DynamicPlugin</span> <span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">implements</span> <span class=3D"hljs-title" style=3D"=
color: rgb(181,137,0);">Interceptor</span> </span>{

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">protected=
</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">stati=
c</span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">fina=
l</span> Logger logger =3D LoggerFactory.getLogger(DynamicPlugin.class);

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> String REGEX =3D <span class=3D"hljs-string" style=3D"color: rgb(42,=
161,152);">".*insert\\u0020.*|.*delete\\u0020.*|.*update\\u0020.*"</span>;

    <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">private</=
span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">static<=
/span> <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">final<=
/span> Map&lt;String, DynamicDataSourceGlobal&gt; cacheMap =3D <span class=
=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">new</span> ConcurrentHas=
hMap&lt;&gt;();

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">intercept</span><span class=3D"hljs-params" st=
yle=3D"color: rgb(102,0,102);">(Invocation invocation)</span> <span class=
=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">throws</span> Throwable =
</span>{

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">boole=
an</span> synchronizationActive =3D TransactionSynchronizationManager.isSyn=
chronizationActive();
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan>(!synchronizationActive) {
            Object[] objects =3D invocation.getArgs();
            MappedStatement ms =3D (MappedStatement) objects[<span class=3D=
"hljs-number" style=3D"color: rgb(42,161,152);">0</span>];

            DynamicDataSourceGlobal dynamicDataSourceGlobal =3D <span class=
=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">null</span>;

            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">i=
f</span>((dynamicDataSourceGlobal =3D cacheMap.get(ms.getId())) =3D=3D <spa=
n class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">null</span>) {
                <span class=3D"hljs-comment" style=3D"color: rgb(147,161,16=
1);">//=E8=AF=BB=E6=96=B9=E6=B3=95</span>
                <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0)=
;">if</span>(ms.getSqlCommandType().equals(SqlCommandType.SELECT)) {
                    <span class=3D"hljs-comment" style=3D"color: rgb(147,16=
1,161);">//!selectKey =E4=B8=BA=E8=87=AA=E5=A2=9Eid=E6=9F=A5=E8=AF=A2=E4=B8=
=BB=E9=94=AE(SELECT LAST_INSERT_ID() )=E6=96=B9=E6=B3=95=EF=BC=8C=E4=BD=BF=
=E7=94=A8=E4=B8=BB=E5=BA=93</span>
                    <span class=3D"hljs-keyword" style=3D"color: rgb(133,15=
3,0);">if</span>(ms.getId().contains(SelectKeyGenerator.SELECT_KEY_SUFFIX))=
 {
                        dynamicDataSourceGlobal =3D DynamicDataSourceGlobal=
.WRITE;
                    } <span class=3D"hljs-keyword" style=3D"color: rgb(133,=
153,0);">else</span> {
                        BoundSql boundSql =3D ms.getSqlSource().getBoundSql=
(objects[<span class=3D"hljs-number" style=3D"color: rgb(42,161,152);">1</s=
pan>]);
                        String sql =3D boundSql.getSql().toLowerCase(Locale=
.CHINA).replaceAll(<span class=3D"hljs-string" style=3D"color: rgb(42,161,1=
52);">"[\\t\\n\\r]"</span>, <span class=3D"hljs-string" style=3D"color: rgb=
(42,161,152);">" "</span>);
                        <span class=3D"hljs-keyword" style=3D"color: rgb(13=
3,153,0);">if</span>(sql.matches(REGEX)) {
                            dynamicDataSourceGlobal =3D DynamicDataSourceGl=
obal.WRITE;
                        } <span class=3D"hljs-keyword" style=3D"color: rgb(=
133,153,0);">else</span> {
                            dynamicDataSourceGlobal =3D DynamicDataSourceGl=
obal.READ;
                        }
                    }
                }<span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0=
);">else</span>{
                    dynamicDataSourceGlobal =3D DynamicDataSourceGlobal.WRI=
TE;
                }
                logger.warn(<span class=3D"hljs-string" style=3D"color: rgb=
(42,161,152);">"=E8=AE=BE=E7=BD=AE=E6=96=B9=E6=B3=95[{}] use [{}] Strategy,=
 SqlCommandType [{}].."</span>, ms.getId(), dynamicDataSourceGlobal.name(),=
 ms.getSqlCommandType().name());
                cacheMap.put(ms.getId(), dynamicDataSourceGlobal);
            }
            DynamicDataSourceHolder.putDataSource(dynamicDataSourceGlobal);
        }

        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">retur=
n</span> invocation.proceed();
    }

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> Object <span class=3D"hljs-title" style=
=3D"color: rgb(38,139,210);">plugin</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(Object target)</span> </span>{
        <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">if</s=
pan> (target <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">=
instanceof</span> Executor) {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> Plugin.wrap(target, <span class=3D"hljs-keyword" style=3D"colo=
r: rgb(133,153,0);">this</span>);
        } <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">els=
e</span> {
            <span class=3D"hljs-keyword" style=3D"color: rgb(133,153,0);">r=
eturn</span> target;
        }
    }

    <span class=3D"hljs-annotation" style=3D"color: rgb(155,133,157);">@Ove=
rride</span>
    <span class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or: rgb(133,153,0);">public</span> <span class=3D"hljs-keyword" style=3D"co=
lor: rgb(133,153,0);">void</span> <span class=3D"hljs-title" style=3D"color=
: rgb(38,139,210);">setProperties</span><span class=3D"hljs-params" style=
=3D"color: rgb(102,0,102);">(Properties properties)</span> </span>{
        <span class=3D"hljs-comment" style=3D"color: rgb(147,161,161);">//<=
/span>
    }</code></pre>
    </div>
</body>
</html>
------=_Part_10590_150982930.1546418142110--
